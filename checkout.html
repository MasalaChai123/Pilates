
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>çµå¸³ - 9's Pilates Studio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
      body {
        font-family: 'Noto Sans TC', sans-serif;
        background-color: #efefef;
        color: #292524; /* text-stone-800 */
      }
      .font-serif {
        font-family: 'Playfair Display', serif;
      }
      .transform { transition: transform 0.3s ease-in-out; }
      .opacity-transition { transition: opacity 0.3s ease-in-out; }
        .notification-item {
            padding: 0.75rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
            display: block;
            text-decoration: none;
        }
        .notification-item:hover {
            background-color: #f5f5f4; /* stone-100 */
        }
        .notification-item.unread {
            background-color: #f7f5f2; /* A lighter version of brand color */
        }
        .notification-item p {
            font-size: 0.875rem;
            line-height: 1.25rem;
            color: #44403c; /* stone-700 */
            margin-bottom: 0;
        }
        .notification-item time {
            font-size: 0.75rem;
            line-height: 1rem;
            color: #a8a29e; /* stone-400 */
            margin-top: 0.25rem;
            display: block;
        }
        #personal-notifications-list::-webkit-scrollbar { width: 6px; }
        #personal-notifications-list::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 3px;}
        #personal-notifications-list::-webkit-scrollbar-thumb { background: #d4d4d4; border-radius: 3px;}
        #personal-notifications-list::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }
    </style>
     <style id="auth-modal-styles">
        .auth-modal-backdrop { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(5px); z-index: 1000; opacity: 0; transition: opacity 0.3s ease-out; pointer-events: none; }
        .auth-modal-backdrop.active { opacity: 1; pointer-events: auto; }
        .auth-modal-container { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.95); z-index: 1001; opacity: 0; transition: opacity 0.3s ease-out, transform 0.3s ease-out; pointer-events: none; width: 100%; max-width: 450px; padding: 20px; max-height: 95vh; overflow-y: auto; }
        .auth-modal-container.active { opacity: 1; transform: translate(-50%, -50%) scale(1); pointer-events: auto; }
        .auth-card { background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(20px); border-radius: 20px; padding: 40px; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15); border: 1px solid rgba(255, 255, 255, 0.2); width: 100%; position: relative; overflow: hidden; }
        .auth-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, #d1cfcd, #c1bcb8, #d1cfcd); }
        .auth-header { text-align: center; margin-bottom: 30px; }
        .auth-title { font-size: 28px; font-weight: 700; margin-bottom: 8px; background: linear-gradient(135deg, #333, #555); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .auth-subtitle { color: #666; font-size: 14px; }
        .form-group { margin-bottom: 20px; position: relative; }
        .form-label { display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 14px; }
        .form-control { width: 100%; padding: 15px 20px; border: 2px solid #e8e8e8; border-radius: 12px; font-size: 16px; transition: all 0.3s ease; background: rgba(255, 255, 255, 0.8); }
        .form-control:focus { outline: none; border-color: #c1bcb8; box-shadow: 0 0 0 4px rgba(193, 188, 184, 0.1); background: white; }
        .password-field { position: relative; }
        .password-toggle { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); background: none; border: none; color: #666; cursor: pointer; font-size: 14px; padding: 5px; }
        .checkbox-group { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; }
        .checkbox { width: 18px; height: 18px; accent-color: #c1bcb8; }
        .checkbox-label { font-size: 14px; color: #666; flex: 1; }
        .checkbox-label a { color: #c1bcb8; text-decoration: underline; }
        .btn { display: inline-flex; align-items: center; justify-content: center; padding: 15px 24px; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; text-decoration: none; gap: 8px; width: 100%; }
        .btn-primary { background: linear-gradient(135deg, #c1bcb8, #b0a9a4); color: white; box-shadow: 0 8px 25px rgba(193, 188, 184, 0.3); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 12px 35px rgba(193, 188, 184, 0.4); }
        .social-buttons { margin-top: 20px; }
        .btn-social { background: white; border: 2px solid #e8e8e8; color: #666; margin-bottom: 12px; font-weight: 500; }
        .btn-social:hover { border-color: #c1bcb8; color: #c1bcb8; background: rgba(193, 188, 184, 0.1); }
        .btn-social span { display: flex; align-items: center; justify-content: center; gap: 10px; width: 100%; }
        .btn-social svg { width: 20px; height: 20px; }
        .divider { text-align: center; margin: 25px 0; position: relative; color: #999; font-size: 14px; }
        .divider::before { content: ''; position: absolute; top: 50%; left: 0; right: 0; height: 1px; background: #e8e8e8; z-index: 0; }
        .divider span { background: #fff; padding: 0 15px; position: relative; z-index: 1; }
        .auth-switch { text-align: center; margin-top: 25px; padding-top: 25px; border-top: 1px solid #e8e8e8; color: #666; font-size: 14px; }
        .auth-switch a { color: #c1bcb8; font-weight: 600; text-decoration: none; cursor: pointer; }
        .forgot-password { text-align: center; margin-top: 15px; }
        .forgot-password a { color: #c1bcb8; font-size: 14px; text-decoration: none; cursor: pointer; }
        .auth-view { display: none; animation: fadeIn 0.3s ease-out; }
        .auth-view.active { display: block; }
        .back-link { display: inline-flex; align-items: center; gap: 5px; color: #c1bcb8; font-size: 14px; margin-bottom: 20px; cursor: pointer; }
        .success-message { background: linear-gradient(135deg, #00b894, #00a085); color: white; padding: 15px 20px; border-radius: 12px; margin-bottom: 20px; text-align: center; font-weight: 500; display: none; }
        .success-message.show { display: block; }
        .auth-modal-close-btn { position: absolute; top: 15px; right: 15px; background: none; border: none; cursor: pointer; color: #999; font-size: 24px; line-height: 1; padding: 5px; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="bg-stone-50 text-stone-800">

    <!-- Header -->
    <header class="sticky top-0 bg-[#e3dfdc]/80 backdrop-blur-md z-40 shadow-sm">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-20">
          <div class="flex-shrink-0">
            <a href="index.html" class="flex items-center space-x-2">
               <img class="h-10 w-auto" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMDAiIGhlaWdodD0iNzgiIHZpZXdCb3g9IjAgMCAzMDAgNzgiPjxzdHlsZT4ud2VpZ2h0LTkwMCB7IGZvbnQtd2VpZ2h0OiA5MDA7IH0gLmN1cnNpdmUgeyBmb250LWZhbWlseTogJ1BsYXlmYWlyIERpc3BsYXksIHNlcmlmJzsgZm9udC1zdHlsZTogaXRhbGljOyB9IC5zZXJpZiB7IGZvbnQtZmFtaWx5OiAnUGxheWZhaXIgRGlzcGxheScsIHNlcmlmOyB9PC9zdHlsZT48dGV4dCB4PSIxMCIgeT0iNzAiIGZvbnQtZmFtaWx5PSJQbGF5ZmFpciBEaXNwbGF5LCBzZXJpZiIgZm9udC1zaXplPSI5MCIgZmlsbD0iIzAwMCI+PXRzcGFuIHg9IjEwIiBkeT0iMCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjIiPkY8L3RzcGFuPjx0c3BhbiB4PSI0OCIgZHk9IjAiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLXdpZHRoPSIxIj5GOy90c3Bhbj48L3RleHQ+PHRleHQgeD0iMTA1IiB5PSI1MiIgc3R5bGU9ImZvbnQtZmFtaWx5OiAnUGxheWZhaXIgRGlzcGxheScsIHNlcmlmOyBmb250LXNpemU6IDI4cHc7IGxldHRlci1zcGFjaW5nOiAycHg7Ij48dHNwYW4geD0iMTA1IiBkeT0iMCIgY2xhc3M9ImN1cnNpdmUiPjwnczwvdHNwYW4+PHRzcGFuIHg9IjE0MCIgZHk9IiI+IFBJTFRFUzwvdHNwYW4+PC90ZXh0Pjwvc3ZnPg==" alt="9's Pilates Logo" />
            </a>
          </div>
          <nav class="hidden lg:flex lg:items-center lg:space-x-8">
            <a href="courses.html#single-session" class="text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_single_session">å–®å ‚é«”é©—</a>
            <a href="courses.html#thematic-unit" class="text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_thematic_unit">ä¸»é¡Œå–®å…ƒ</a>
            <a href="courses.html#sculpting-plan" class="text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_sculpting_plan">é«”æ…‹é›•å¡‘</a>
            <a href="#" class="text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_faq">å¸¸è¦‹å•é¡Œ</a>
          </nav>
          <div class="flex items-center space-x-4">
            <button id="language-switcher-button" class="text-stone-600 hover:text-[#c1bcb8] transition-colors flex items-center space-x-1" aria-label="Switch language">
                <i class="fas fa-globe"></i>
                <span id="current-lang-text" class="text-sm font-medium">ç¹ä¸­</span>
            </button>
             <button id="user-icon-button" class="relative text-stone-600 hover:text-[#c1bcb8] transition-colors" aria-label="User account">
                <i aria-hidden="true" class="fas fa-user text-xl"></i> 
             </button>
             <div class="relative">
                <button id="notification-button" class="relative text-stone-600 hover:text-[#c1bcb8] transition-colors" aria-label="Open notifications">
                    <i aria-hidden="true" class="fas fa-bell text-xl"></i>
                    <span id="notification-dot" class="absolute -top-1 -right-1 flex h-3 w-3 items-center justify-center hidden">
                        <span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span>
                    </span>
                </button>
            </div>
            <button id="cart-button" class="relative text-stone-600 hover:text-[#c1bcb8] transition-colors" aria-label="Open shopping cart">
              <i aria-hidden="true" class="fas fa-shopping-cart text-xl"></i>
              <span id="cart-item-count" class="absolute -top-2 -right-2 flex h-5 w-5 items-center justify-center rounded-full bg-[#c1bcb8] text-xs font-medium text-white hidden">0</span>
            </button>
            <button id="login-logout-button" class="hidden lg:block text-stone-600 hover:text-[#c1bcb8] transition-colors font-medium text-sm px-3 py-2 rounded-md"></button>
            <button id="menu-button" class="lg:hidden text-stone-600 hover:text-[#c1bcb8] transition-colors" aria-label="Open menu">
              <i aria-hidden="true" class="fas fa-bars text-xl"></i>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Notification Panel -->
    <div id="notification-panel" class="hidden fixed top-20 right-4 sm:right-6 lg:right-8 w-80 max-w-sm bg-white rounded-lg shadow-2xl border border-stone-200 z-50 flex flex-col max-h-[500px]">
        <!-- Announcements Section -->
        <div class="p-3 border-b border-stone-200 flex-shrink-0">
            <div class="flex justify-between items-center mb-1">
                <h3 class="font-semibold text-stone-700" data-translate-key="notifications_announcements">å…¬å‘Š</h3>
                <a href="#" id="view-all-announcements" class="text-sm text-[#c1bcb8] hover:underline flex items-center">
                    <span data-translate-key="notifications_view_all">æŸ¥çœ‹å…¨éƒ¨</span> (<span id="announcements-count">0</span>)
                    <i class="fas fa-chevron-right text-xs ml-1"></i>
                </a>
            </div>
            <div id="latest-announcement-container">
                <!-- Latest announcement item here -->
            </div>
        </div>
        <!-- Personal Notifications Section -->
        <div class="p-3 flex flex-col flex-grow min-h-0">
            <h3 class="font-semibold text-stone-700 mb-2 flex-shrink-0" data-translate-key="notifications_personal">é€šçŸ¥</h3>
            <div id="personal-notifications-list" class="flex-grow overflow-y-auto pr-2 space-y-1">
                <!-- Personal notification items here -->
            </div>
            <div class="text-center mt-2 flex-shrink-0">
                <button id="load-more-notifications" class="hidden text-sm font-semibold text-[#c1bcb8] hover:underline" data-translate-key="notifications_load_more">è¼‰å…¥æ›´å¤š</button>
            </div>
        </div>
    </div>

    <!-- Mobile Menu, Cart Panel, Auth Modal (copied for consistency) -->
    <div id="mobile-menu-backdrop" class="fixed inset-0 bg-black bg-opacity-50 z-40 opacity-transition opacity-0 pointer-events-none lg:hidden"></div>
    <div id="mobile-menu-panel" class="fixed top-0 left-0 h-full w-64 bg-white shadow-2xl z-50 transform -translate-x-full lg:hidden"><div class="flex flex-col h-full"><div class="flex items-center justify-between p-6 border-b border-stone-200"><h2 class="text-xl font-semibold text-stone-800" data-translate-key="mobile_menu_title">é¸å–®</h2><button id="mobile-menu-close" class="text-stone-500 hover:text-stone-800 transition-colors"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg></button></div><nav class="flex-grow p-6"><ul class="space-y-4"><li><a href="courses.html#single-session" class="mobile-menu-link block py-2 text-lg text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_single_session">å–®å ‚é«”é©—</a></li><li><a href="courses.html#thematic-unit" class="mobile-menu-link block py-2 text-lg text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_thematic_unit">ä¸»é¡Œå–®å…ƒ</a></li><li><a href="courses.html#sculpting-plan" class="mobile-menu-link block py-2 text-lg text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_sculpting_plan">é«”æ…‹é›•å¡‘</a></li><li><a href="#" class="mobile-menu-link block py-2 text-lg text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_faq">å¸¸è¦‹å•é¡Œ</a></li></ul></nav><div class="border-t border-stone-200 mt-auto p-6"><a href="#" id="mobile-login-logout-link" class="block py-2 text-lg text-stone-600 hover:text-[#c1bcb8] transition-colors"></a></div></div></div>
    <div id="cart-backdrop" class="fixed inset-0 bg-black bg-opacity-50 z-40 opacity-transition opacity-0 pointer-events-none"></div>
    <div id="cart-panel" class="fixed top-0 right-0 h-full w-full max-w-md bg-white shadow-2xl z-50 transform translate-x-full"><div class="flex flex-col h-full"><div class="flex items-center justify-between p-6 border-b border-stone-200"><h2 class="text-xl font-semibold text-stone-800" data-translate-key="cart_title">è³¼ç‰©è»Š</h2><button id="cart-close-button" class="text-stone-500 hover:text-stone-800 transition-colors"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg></button></div><div id="cart-content" class="flex-grow"></div></div></div>
    
    <div id="auth-modal-backdrop" class="auth-modal-backdrop"></div>
    <div id="auth-modal-container" class="auth-modal-container">
        <div class="auth-card">
            <button id="auth-modal-close-btn" class="auth-modal-close-btn">&times;</button>
            <!-- Login View -->
            <div id="loginView" class="auth-view active">
                <div class="auth-header">
                    <h1 class="auth-title" data-translate-key="auth_login_title_checkout">æœƒå“¡ç™»å…¥</h1>
                    <p class="auth-subtitle" data-translate-key="auth_login_subtitle_checkout">ç™»å…¥ä»¥å®Œæˆæ‚¨çš„è¨‚å–®</p>
                </div>
                <form id="loginForm">
                    <div class="form-group">
                        <label class="form-label" data-translate-key="auth_email_label">é›»å­éƒµä»¶</label>
                        <input type="email" class="form-control" placeholder="è¼¸å…¥æ‚¨çš„é›»å­éƒµä»¶" data-translate-key="auth_email_placeholder" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" data-translate-key="auth_password_label">å¯†ç¢¼</label>
                        <div class="password-field">
                            <input type="password" class="form-control password-input" placeholder="è¼¸å…¥æ‚¨çš„å¯†ç¢¼" data-translate-key="auth_password_placeholder" required>
                            <button type="button" class="password-toggle" data-translate-key="auth_show_password">é¡¯ç¤º</button>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="remember" class="checkbox">
                        <label for="remember" class="checkbox-label" data-translate-key="auth_remember_me">è¨˜ä½æˆ‘</label>
                    </div>
                    <div id="login-error-message" class="text-red-500 text-sm text-center mb-4" style="display: none;"></div>
                    <button type="submit" class="btn btn-primary" data-translate-key="auth_login_button">ç™»å…¥</button>
                    <div class="forgot-password"><a class="auth-view-switch" data-view="forgotPassword" data-translate-key="auth_forgot_password">å¿˜è¨˜å¯†ç¢¼ï¼Ÿ</a></div>
                </form>
                <div class="divider"><span data-translate-key="auth_or">æˆ–</span></div>
                <div class="social-buttons">
                    <a href="/auth/google/redirect" class="btn btn-social"><span><svg viewBox="0 0 24 24" fill="#666"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg><span data-translate-key="auth_google_login">ä½¿ç”¨ Google ç™»å…¥</span></span></a>
                    <a href="/auth/line/redirect" class="btn btn-social"><span><svg viewBox="0 0 24 24" fill="#666"><path d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.627-.63.349 0 .631.285.631.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.349 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.282.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"/></svg><span data-translate-key="auth_line_login">ä½¿ç”¨ LINE ç™»å…¥</span></span></a>
                </div>
                <div class="auth-switch"><span data-translate-key="auth_no_account">é‚„æ²’æœ‰å¸³è™Ÿï¼Ÿ</span> <a class="auth-view-switch" data-view="signup" data-translate-key="auth_signup_now">ç«‹å³è¨»å†Š</a></div>
            </div>
            <!-- Sign Up View -->
            <div id="signupView" class="auth-view">
                <div class="auth-header"><h1 class="auth-title" data-translate-key="auth_signup_title">å»ºç«‹å¸³è™Ÿ</h1><p class="auth-subtitle" data-translate-key="auth_signup_subtitle">åŠ å…¥ 9's Pilates é–‹å§‹æ‚¨çš„å¥åº·ä¹‹æ—…</p></div>
                <form id="signupForm">
                    <div class="form-group"><label class="form-label" data-translate-key="auth_name_label">å§“å</label><input type="text" class="form-control" placeholder="è¼¸å…¥æ‚¨çš„å§“å" data-translate-key="auth_name_placeholder" required></div>
                    <div class="form-group"><label class="form-label" data-translate-key="auth_email_label">é›»å­éƒµä»¶</label><input type="email" class="form-control" placeholder="è¼¸å…¥æ‚¨çš„é›»å­éƒµä»¶" data-translate-key="auth_email_placeholder" required></div>
                    <div class="form-group"><label class="form-label" data-translate-key="auth_password_label">å¯†ç¢¼</label><div class="password-field"><input type="password" class="form-control password-input" placeholder="è‡³å°‘8å€‹å­—å…ƒ" data-translate-key="auth_password_placeholder_signup" required><button type="button" class="password-toggle" data-translate-key="auth_show_password">é¡¯ç¤º</button></div></div>
                    <div class="form-group"><label class="form-label" data-translate-key="auth_confirm_password_label">ç¢ºèªå¯†ç¢¼</label><div class="password-field"><input type="password" class="form-control password-input" placeholder="å†æ¬¡è¼¸å…¥å¯†ç¢¼" data-translate-key="auth_confirm_password_placeholder" required><button type="button" class="password-toggle" data-translate-key="auth_show_password">é¡¯ç¤º</button></div></div>
                    <div class="checkbox-group"><input type="checkbox" id="terms" class="checkbox" required><label for="terms" class="checkbox-label" data-translate-key="auth_terms_agree">æˆ‘åŒæ„ <a>æœå‹™æ¢æ¬¾</a> èˆ‡ <a>éš±ç§æ”¿ç­–</a></label></div>
                    <div id="signup-error-message" class="text-red-500 text-sm text-center mb-4" style="display: none;"></div>
                    <button type="submit" class="btn btn-primary" data-translate-key="auth_create_account_button">å»ºç«‹å¸³è™Ÿ</button>
                </form>
                <div class="auth-switch"><span data-translate-key="auth_already_have_account">å·²ç¶“æœ‰å¸³è™Ÿï¼Ÿ</span> <a class="auth-view-switch" data-view="login" data-translate-key="auth_login_now">ç«‹å³ç™»å…¥</a></div>
            </div>
            <!-- Forgot Password View -->
            <div id="forgotPasswordView" class="auth-view">
                <a class="back-link auth-view-switch" data-view="login"><span class="mr-1">â†</span> <span data-translate-key="auth_back_to_login">è¿”å›ç™»å…¥</span></a>
                <div class="auth-header"><h1 class="auth-title" data-translate-key="auth_forgot_password_title">å¿˜è¨˜å¯†ç¢¼</h1><p class="auth-subtitle" data-translate-key="auth_forgot_password_subtitle">è¼¸å…¥æ‚¨çš„é›»å­éƒµä»¶ï¼Œæˆ‘å€‘æœƒç™¼é€å¯†ç¢¼é‡è¨­é€£çµçµ¦æ‚¨</p></div>
                <div id="forgotPasswordSuccess" class="success-message" data-translate-key="auth_forgot_password_success">é‡è¨­å¯†ç¢¼é€£çµå·²ç™¼é€è‡³æ‚¨çš„ä¿¡ç®±ï¼</div>
                <form id="forgotPasswordForm">
                    <div class="form-group"><label class="form-label" data-translate-key="auth_email_label">é›»å­éƒµä»¶</label><input type="email" class="form-control" placeholder="è¼¸å…¥æ‚¨è¨»å†Šçš„é›»å­éƒµä»¶" data-translate-key="auth_registered_email_placeholder" required></div>
                    <button type="submit" class="btn btn-primary" data-translate-key="auth_send_reset_link_button">ç™¼é€é‡è¨­é€£çµ</button>
                </form>
            </div>
        </div>
    </div>

    <main id="checkout-page" class="py-12 md:py-20">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">

            <!-- Empty Cart View -->
            <div id="empty-cart-view" class="hidden text-center py-16 px-6 bg-white rounded-lg shadow-md">
                <div class="text-6xl text-stone-300 mb-4">ğŸ›’</div>
                <h2 class="text-2xl font-bold font-serif text-stone-800 mb-2" data-translate-key="empty_cart_title">æ‚¨çš„è³¼ç‰©è»Šæ˜¯ç©ºçš„</h2>
                <p class="text-stone-500 mb-6" data-translate-key="empty_cart_subtitle">ç«‹å³æ¢ç´¢æˆ‘å€‘çš„èª²ç¨‹ï¼Œé–‹å§‹æ‚¨çš„çš®æ‹‰ææ–¯ä¹‹æ—…å§ï¼</p>
                <a href="courses.html" class="inline-block px-8 py-3 bg-[#c1bcb8] text-white rounded-full font-semibold hover:bg-[#b0a9a4] transition-colors" data-translate-key="browse_courses">
                    ç€è¦½æ‰€æœ‰èª²ç¨‹
                </a>
            </div>

            <!-- Order Success View -->
            <div id="order-success-view" class="hidden text-center py-16 px-6 bg-white rounded-lg shadow-md">
                <div class="text-6xl text-green-500 mb-4">âœ“</div>
                <h2 class="text-2xl font-bold font-serif text-stone-800 mb-2" data-translate-key="order_success_title">æ„Ÿè¬æ‚¨çš„è³¼è²·ï¼</h2>
                <p class="text-stone-500 mb-6" data-translate-key="order_success_subtitle">æ‚¨çš„èª²ç¨‹å·²åŠ å…¥å¸³æˆ¶ä¸­ï¼Œé¦¬ä¸Šé–‹å§‹æ‚¨çš„å¥åº·ä¹‹æ—…å§ï¼</p>
                <a href="dashboard.html" class="inline-block px-8 py-3 bg-[#c1bcb8] text-white rounded-full font-semibold hover:bg-[#b0a9a4] transition-colors" data-translate-key="back_to_dashboard">
                    å‰å¾€æˆ‘çš„èª²ç¨‹
                </a>
            </div>

            <!-- Checkout View -->
            <div id="checkout-view" class="hidden">
                <div class="text-center mb-10">
                    <h1 class="text-4xl sm:text-5xl font-serif font-bold text-stone-800 tracking-tight" data-translate-key="checkout_title">çµå¸³</h1>
                    <p class="mt-4 text-lg text-stone-600" data-translate-key="checkout_subtitle">è«‹ç¢ºèªæ‚¨çš„è¨‚å–®ä¸¦å®Œæˆä»˜æ¬¾</p>
                </div>
                
                <div class="lg:grid lg:grid-cols-12 lg:gap-12 items-start">
                    <!-- Left column: Form -->
                    <div class="lg:col-span-7 bg-white p-6 sm:p-8 rounded-lg shadow-md">
                        <div id="login-prompt" class="hidden text-center p-8 border-2 border-dashed rounded-lg">
                            <h3 class="text-xl font-bold text-stone-700 mb-2" data-translate-key="login_to_checkout">ç™»å…¥ä»¥å®Œæˆçµå¸³</h3>
                            <p class="text-stone-500 mb-4" data-translate-key="login_to_checkout_subtitle">æœƒå“¡çµå¸³ä»¥ç´€éŒ„æ‚¨çš„è³¼è²·è³‡è¨Š</p>
                            <button id="checkout-login-btn" class="btn btn-primary w-auto px-10" data-translate-key="auth_login_button">ç™»å…¥</button>
                        </div>

                        <div id="payment-form-container">
                             <form id="payment-form">
                                <section>
                                    <h2 class="text-xl font-bold font-serif mb-4" data-translate-key="contact_info">è¯çµ¡è³‡è¨Š</h2>
                                    <div class="space-y-4">
                                        <div>
                                            <label for="name" class="form-label" data-translate-key="full_name">å…¨å</label>
                                            <input type="text" id="name" class="form-control" required>
                                        </div>
                                        <div>
                                            <label for="email" class="form-label" data-translate-key="email_address">é›»å­éƒµä»¶</label>
                                            <input type="email" id="email" class="form-control" required>
                                        </div>
                                    </div>
                                </section>
                                <hr class="my-8">
                                <section>
                                    <h2 class="text-xl font-bold font-serif mb-4" data-translate-key="payment_details">ä»˜æ¬¾è³‡è¨Š</h2>
                                    <p class="text-sm text-stone-500 mb-4" data-translate-key="mock_payment_notice">é€™æ˜¯ä¸€å€‹ç¤ºç¯„ç¶²ç«™ï¼Œè«‹å‹¿è¼¸å…¥çœŸå¯¦ä¿¡ç”¨å¡è³‡è¨Šã€‚</p>
                                    <div class="space-y-4">
                                         <div>
                                            <label for="card-number" class="form-label" data-translate-key="card_number">å¡è™Ÿ</label>
                                            <input type="text" id="card-number" class="form-control" placeholder="1234 5678 9123 0000" required>
                                        </div>
                                        <div class="grid grid-cols-2 gap-4">
                                            <div>
                                                <label for="expiry-date" class="form-label" data-translate-key="expiry_date">æœ‰æ•ˆæœŸé™</label>
                                                <input type="text" id="expiry-date" class="form-control" placeholder="MM / YY" required>
                                            </div>
                                            <div>
                                                <label for="cvc" class="form-label" data-translate-key="cvc">CVC</label>
                                                <input type="text" id="cvc" class="form-control" placeholder="123" required>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                                <div class="mt-8">
                                    <button type="submit" class="btn btn-primary w-full text-lg" data-translate-key="place_order">ç¢ºèªä»˜æ¬¾</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Right column: Summary -->
                    <div class="lg:col-span-5 mt-8 lg:mt-0">
                         <div class="bg-white p-6 sm:p-8 rounded-lg shadow-md lg:sticky lg:top-28">
                            <h2 class="text-xl font-bold font-serif mb-4" data-translate-key="order_summary">è¨‚å–®æ‘˜è¦</h2>
                            <div id="order-summary-items" class="space-y-4">
                                <!-- Cart items will be injected here -->
                            </div>
                            <hr class="my-6">
                            <div class="space-y-2">
                                <div class="flex items-center">
                                    <input type="text" id="coupon-code" class="form-control flex-grow mr-2 text-sm" data-translate-key="coupon_placeholder" placeholder="è¼¸å…¥å„ªæƒ ç¢¼">
                                    <button id="apply-coupon-btn" class="px-4 py-2 bg-stone-200 text-stone-700 rounded-lg text-sm font-semibold hover:bg-stone-300 transition-colors whitespace-nowrap" data-translate-key="apply_coupon">å¥—ç”¨</button>
                                </div>
                                <p id="coupon-status" class="text-xs text-center h-4"></p>
                            </div>
                            <hr class="my-4">
                            <div id="price-summary" class="space-y-2">
                                <!-- Price details will be injected here -->
                            </div>
                         </div>
                    </div>
                </div>
            </div>

        </div>
    </main>
    
    <!-- Footer -->
    <footer class="bg-stone-800 text-stone-300 mt-16">
        <div class="container mx-auto py-12 px-4 sm:px-6 lg:px-8 text-center"><img class="h-12 w-auto mx-auto mb-4" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMDAiIGhlaWdodD0iNzgiIHZpZXdCb3g9IjAgMCAzMDAgNzgiPjxzdHlsZT4ud2VpZ2h0LTkwMCB7IGZvbnQtd2VpZ2h0OiA5MDA7IH0gLmN1cnNpdmUgeyBmb250LWZhbWlseTogJ1BsYXlmYWlyIERpc3BsYXksIHNlcmlmJzsgZm9udC1zdHlsZTogaXRhbGljOyB9IC5zZXJpZiB7IGZvbnQtZmFtaWx5OiAnUGxheWZhaXIgRGlzcGxheScsIHNlcmlmOyB9PC9zdHlsZT48dGV4dCB4PSIxMCIgeT0iNzAiIGZvbnQtZmFtaWx5PSJQbGF5ZmFpciBEaXNwbGF5LCBzZXJpZiIgZm9udC1zaXplPSI5MCIgZmlsbD0iI2ZmZiI+PXRzcGFuIHg9IjEwIiBkeT0iMCIgc3Ryb2tlPSIjZmZmIiBzdHJva2Utd2lkdGg9IjIiPkY8L3RzcGFuPjx0c3BhbiB4PSI0OCIgZHk9IjAiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxIj5GOy90c3Bhbj48L3RleHQ+PHRleHQgeD0iMTA1IiB5PSI1MiIgc3R5bGU9ImZvbnQtZmFtaWx5OiAnUGxheWZhaXIgRGlzcGxheScsIHNlcmlmOyBmb250LXNpemU6IDI4cHc7IGxldHRlci1zcGFjaW5nOiAycHg7IGZpbGw6ICNmZmY7Ij48dHNwYW4geD0iMTA1IiBkeT0iMCIgY2xhc3M9ImN1cnNpdmUiPjwnczwvdHNwYW4+PHRzcGFuIHg9IjE0MCIgZHk9IiI+IFBJTFRFUzwvdHNwYW4+PC90ZXh0Pjwvc3ZnPg==" alt="9's Pilates" /><div class="flex justify-center space-x-6 my-6"><a href="courses.html" class="hover:text-white transition-colors" data-translate-key="footer_all_courses">æ‰€æœ‰èª²ç¨‹</a><a href="#" class="hover:text-white transition-colors" data-translate-key="nav_faq">å¸¸è¦‹å•é¡Œ</a><a href="#" id="footer-login-link" class="hover:text-white transition-colors" data-translate-key="footer_member_login">æœƒå“¡ç™»å…¥</a></div><p class="my-4"><a href="mailto:9spilates@gmail.com" class="hover:text-white transition-colors"><span data-translate-key="footer_contact_email">å®¢æœä¿¡ç®±</span>ï¼š9spilates@gmail.com</a></p><div class="flex justify-center space-x-6 my-6"><a href="#" class="text-stone-400 hover:text-white transition-colors" aria-label="Instagram"><i class="fab fa-instagram text-2xl"></i></a><a href="#" class="text-stone-400 hover:text-white transition-colors" aria-label="Line"><i class="fab fa-line text-2xl"></i></a></div><p class="text-sm text-stone-400" data-translate-key="footer_copyright">Â© 2025 9's Pilates. ç‰ˆæ¬Šæ‰€æœ‰</p><div class="flex justify-center space-x-4 mt-2 text-xs text-stone-500"><a href="terms.html" class="hover:text-stone-300 transition-colors" data-translate-key="footer_terms">ä½¿ç”¨æ¢æ¬¾</a><span>|</span><a href="privacy.html" class="hover:text-stone-300 transition-colors" data-translate-key="footer_privacy">éš±ç§æ”¿ç­–</a></div></div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- TRANSLATIONS ---
        const translations = {
            'en': {
                'page_title_checkout': "Checkout - 9's Pilates Studio",
                'nav_single_session': 'Single Session', 'nav_thematic_unit': 'Thematic Unit', 'nav_sculpting_plan': 'Body Sculpting', 'nav_faq': 'FAQ',
                'mobile_menu_title': 'Menu', 'cart_title': 'Shopping Cart', 'cart_empty': 'Your cart is empty', 'cart_continue_shopping': 'Continue Shopping',
                'cart_subtotal': 'Subtotal', 'cart_checkout': 'Checkout', 'footer_all_courses': 'All Courses', 'footer_member_login': 'Member Login', 'footer_contact_email': 'Contact Email',
                'footer_copyright': 'Â© 2025 9\'s Pilates. All Rights Reserved', 'footer_terms': 'Terms of Use', 'footer_privacy': 'Privacy Policy', 'logout_confirm': 'Are you sure you want to log out?', 'already_logged_in': 'You are already logged in.',
                'login': 'Log In', 'logout': 'Log Out',
                'notifications_announcements': 'Announcements', 'notifications_personal': 'Notifications', 'notifications_no_items': 'No items to show',
                'notifications_view_all': 'View All', 'notifications_load_more': 'Load More',
                'auth_login_title': 'Member Login', 'auth_login_subtitle': 'Log in to begin your Pilates journey', 'auth_email_label': 'Email', 'auth_email_placeholder': 'Enter your email',
                'auth_password_label': 'Password', 'auth_password_placeholder': 'Enter your password', 'auth_show_password': 'Show', 'auth_hide_password': 'Hide', 'auth_remember_me': 'Remember me',
                'auth_login_button': 'Log In', 'auth_forgot_password': 'Forgot password?', 'auth_or': 'or', 'auth_google_login': 'Sign in with Google', 'auth_line_login': 'Sign in with LINE',
                'auth_no_account': 'Don\'t have an account?', 'auth_signup_now': 'Sign up now', 'auth_login_error': 'Invalid email or password. Hint: test@example.com / password123',
                'auth_signup_title': 'Create Account', 'auth_signup_subtitle': 'Join 9\'s Pilates to start your wellness journey', 'auth_name_label': 'Name', 'auth_name_placeholder': 'Enter your name',
                'auth_password_placeholder_signup': 'At least 8 characters', 'auth_confirm_password_label': 'Confirm Password', 'auth_confirm_password_placeholder': 'Enter password again',
                'auth_terms_agree': 'I agree to the <a>Terms of Service</a> and <a>Privacy Policy</a>', 'auth_create_account_button': 'Create Account',
                'auth_already_have_account': 'Already have an account?', 'auth_login_now': 'Log in now', 'auth_back_to_login': 'Back to login',
                'auth_forgot_password_title': 'Forgot Password', 'auth_forgot_password_subtitle': 'Enter your email and we\'ll send you a reset link',
                'auth_forgot_password_success': 'A password reset link has been sent to your email!', 'auth_registered_email_placeholder': 'Enter your registered email',
                'auth_send_reset_link_button': 'Send Reset Link', 'auth_passwords_no_match': 'Passwords do not match.', 'auth_signup_error': 'An error occurred. Please try again.',
                'auth_login_title_checkout': 'Member Login', 'auth_login_subtitle_checkout': 'Log in to complete your order',
                // Checkout page specific
                'checkout_title': 'Checkout', 'checkout_subtitle': 'Please confirm your order and complete payment',
                'empty_cart_title': 'Your Cart is Empty', 'empty_cart_subtitle': 'Explore our courses to start your Pilates journey!', 'browse_courses': 'Browse All Courses',
                'order_summary': 'Order Summary', 'item': 'Item', 'price': 'Price', 'subtotal': 'Subtotal', 'discount': 'Discount', 'total_amount': 'Total',
                'coupon_code': 'Coupon Code', 'apply_coupon': 'Apply', 'coupon_placeholder': 'Enter coupon code', 'invalid_coupon': 'Invalid coupon code.', 'coupon_applied': 'Coupon applied!',
                'contact_info': 'Contact Information', 'payment_details': 'Payment Details', 'full_name': 'Full Name', 'email_address': 'Email Address',
                'card_number': 'Card Number', 'expiry_date': 'Expiry Date', 'cvc': 'CVC', 'place_order': 'Place Order', 'mock_payment_notice': "This is a demo site. Do not enter real credit card information.",
                'login_to_checkout': 'Log In to Check Out', 'login_to_checkout_subtitle': 'Log in to record your purchase history.',
                'order_success_title': 'Thank you for your purchase!', 'order_success_subtitle': 'Your courses have been added to your account. Start your wellness journey now!', 'back_to_dashboard': 'Go to My Courses'
            },
            'zh-TW': {
                'page_title_checkout': "çµå¸³ - 9's Pilates Studio",
                'nav_single_session': 'å–®å ‚é«”é©—', 'nav_thematic_unit': 'ä¸»é¡Œå–®å…ƒ', 'nav_sculpting_plan': 'é«”æ…‹é›•å¡‘', 'nav_faq': 'å¸¸è¦‹å•é¡Œ',
                'mobile_menu_title': 'é¸å–®', 'cart_title': 'è³¼ç‰©è»Š', 'cart_empty': 'æ‚¨çš„è³¼ç‰©è»Šæ˜¯ç©ºçš„', 'cart_continue_shopping': 'ç¹¼çºŒé¸è³¼',
                'cart_subtotal': 'å°è¨ˆ', 'cart_checkout': 'å‰å¾€çµå¸³', 'footer_all_courses': 'æ‰€æœ‰èª²ç¨‹', 'footer_member_login': 'æœƒå“¡ç™»å…¥', 'footer_contact_email': 'å®¢æœä¿¡ç®±',
                'footer_copyright': 'Â© 2025 9\'s Pilates. ç‰ˆæ¬Šæ‰€æœ‰', 'footer_terms': 'ä½¿ç”¨æ¢æ¬¾', 'footer_privacy': 'éš±ç§æ”¿ç­–', 'logout_confirm': 'æ‚¨ç¢ºå®šè¦ç™»å‡ºå—ï¼Ÿ', 'already_logged_in': 'æ‚¨å·²ç¶“ç™»å…¥ã€‚',
                'login': 'ç™»å…¥', 'logout': 'ç™»å‡º',
                'notifications_announcements': 'å…¬å‘Š', 'notifications_personal': 'é€šçŸ¥', 'notifications_no_items': 'ç›®å‰æ²’æœ‰ä»»ä½•é …ç›®',
                'notifications_view_all': 'æŸ¥çœ‹å…¨éƒ¨', 'notifications_load_more': 'è¼‰å…¥æ›´å¤š',
                'auth_login_title': 'æœƒå“¡ç™»å…¥', 'auth_login_subtitle': 'ç™»å…¥é–‹å§‹æ‚¨çš„çš®æ‹‰ææ–¯ä¹‹æ—…', 'auth_email_label': 'é›»å­éƒµä»¶', 'auth_email_placeholder': 'è¼¸å…¥æ‚¨çš„é›»å­éƒµä»¶',
                'auth_password_label': 'å¯†ç¢¼', 'auth_password_placeholder': 'è¼¸å…¥æ‚¨çš„å¯†ç¢¼', 'auth_show_password': 'é¡¯ç¤º', 'auth_hide_password': 'éš±è—', 'auth_remember_me': 'è¨˜ä½æˆ‘',
                'auth_login_button': 'ç™»å…¥', 'auth_forgot_password': 'å¿˜è¨˜å¯†ç¢¼ï¼Ÿ', 'auth_or': 'æˆ–', 'auth_google_login': 'ä½¿ç”¨ Google ç™»å…¥', 'auth_line_login': 'ä½¿ç”¨ LINE ç™»å…¥',
                'auth_no_account': 'é‚„æ²’æœ‰å¸³è™Ÿï¼Ÿ', 'auth_signup_now': 'ç«‹å³è¨»å†Š', 'auth_login_error': 'é›»å­éƒµä»¶æˆ–å¯†ç¢¼éŒ¯èª¤ã€‚æç¤ºï¼štest@example.com / password123',
                'auth_signup_title': 'å»ºç«‹å¸³è™Ÿ', 'auth_signup_subtitle': 'åŠ å…¥ 9\'s Pilates é–‹å§‹æ‚¨çš„å¥åº·ä¹‹æ—…', 'auth_name_label': 'å§“å',
                'auth_name_placeholder': 'è¼¸å…¥æ‚¨çš„å§“å', 'auth_password_placeholder_signup': 'è‡³å°‘8å€‹å­—å…ƒ', 'auth_confirm_password_label': 'ç¢ºèªå¯†ç¢¼',
                'auth_confirm_password_placeholder': 'å†æ¬¡è¼¸å…¥å¯†ç¢¼', 'auth_terms_agree': 'æˆ‘åŒæ„ <a>æœå‹™æ¢æ¬¾</a> èˆ‡ <a>éš±ç§æ”¿ç­–</a>',
                'auth_create_account_button': 'å»ºç«‹å¸³è™Ÿ', 'auth_already_have_account': 'å·²ç¶“æœ‰å¸³è™Ÿï¼Ÿ', 'auth_login_now': 'ç«‹å³ç™»å…¥',
                'auth_back_to_login': 'è¿”å›ç™»å…¥', 'auth_forgot_password_title': 'å¿˜è¨˜å¯†ç¢¼',
                'auth_forgot_password_subtitle': 'è¼¸å…¥æ‚¨çš„é›»å­éƒµä»¶ï¼Œæˆ‘å€‘æœƒç™¼é€å¯†ç¢¼é‡è¨­é€£çµçµ¦æ‚¨', 'auth_forgot_password_success': 'é‡è¨­å¯†ç¢¼é€£çµå·²ç™¼é€è‡³æ‚¨çš„ä¿¡ç®±ï¼',
                'auth_registered_email_placeholder': 'è¼¸å…¥æ‚¨è¨»å†Šçš„é›»å­éƒµä»¶', 'auth_send_reset_link_button': 'ç™¼é€é‡è¨­é€£çµ',
                'auth_passwords_no_match': 'å…©æ¬¡è¼¸å…¥çš„å¯†ç¢¼ä¸ä¸€è‡´ã€‚', 'auth_signup_error': 'è¨»å†Šæ™‚ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚',
                'auth_login_title_checkout': 'æœƒå“¡ç™»å…¥', 'auth_login_subtitle_checkout': 'ç™»å…¥ä»¥å®Œæˆæ‚¨çš„è¨‚å–®',
                // Checkout page specific
                'checkout_title': 'çµå¸³', 'checkout_subtitle': 'è«‹ç¢ºèªæ‚¨çš„è¨‚å–®ä¸¦å®Œæˆä»˜æ¬¾',
                'empty_cart_title': 'æ‚¨çš„è³¼ç‰©è»Šæ˜¯ç©ºçš„', 'empty_cart_subtitle': 'ç«‹å³æ¢ç´¢æˆ‘å€‘çš„èª²ç¨‹ï¼Œé–‹å§‹æ‚¨çš„çš®æ‹‰ææ–¯ä¹‹æ—…å§ï¼', 'browse_courses': 'ç€è¦½æ‰€æœ‰èª²ç¨‹',
                'order_summary': 'è¨‚å–®æ‘˜è¦', 'item': 'é …ç›®', 'price': 'åƒ¹æ ¼', 'subtotal': 'å°è¨ˆ', 'discount': 'æŠ˜æ‰£', 'total_amount': 'ç¸½é‡‘é¡',
                'coupon_code': 'å„ªæƒ ç¢¼', 'apply_coupon': 'å¥—ç”¨', 'coupon_placeholder': 'è¼¸å…¥å„ªæƒ ç¢¼', 'invalid_coupon': 'ç„¡æ•ˆçš„å„ªæƒ ç¢¼', 'coupon_applied': 'å·²å¥—ç”¨å„ªæƒ ï¼',
                'contact_info': 'è¯çµ¡è³‡è¨Š', 'payment_details': 'ä»˜æ¬¾è³‡è¨Š', 'full_name': 'å…¨å', 'email_address': 'é›»å­éƒµä»¶',
                'card_number': 'å¡è™Ÿ', 'expiry_date': 'æœ‰æ•ˆæœŸé™', 'cvc': 'CVC', 'place_order': 'ç¢ºèªä»˜æ¬¾', 'mock_payment_notice': "é€™æ˜¯ä¸€å€‹ç¤ºç¯„ç¶²ç«™ï¼Œè«‹å‹¿è¼¸å…¥çœŸå¯¦ä¿¡ç”¨å¡è³‡è¨Šã€‚",
                'login_to_checkout': 'ç™»å…¥ä»¥å®Œæˆçµå¸³', 'login_to_checkout_subtitle': 'æœƒå“¡çµå¸³ä»¥ç´€éŒ„æ‚¨çš„è³¼è²·è³‡è¨Šã€‚',
                'order_success_title': 'æ„Ÿè¬æ‚¨çš„è³¼è²·ï¼', 'order_success_subtitle': 'æ‚¨çš„èª²ç¨‹å·²åŠ å…¥å¸³æˆ¶ä¸­ï¼Œé¦¬ä¸Šé–‹å§‹æ‚¨çš„å¥åº·ä¹‹æ—…å§ï¼', 'back_to_dashboard': 'å‰å¾€æˆ‘çš„èª²ç¨‹'
            }
        };

        const dummyNotifications = {
            announcements: [
                { id: 1, content: {'zh-TW': 'ç³»çµ±å°‡æ–¼ 08/15 å‡Œæ™¨ 02:00-04:00 é€²è¡Œç¶­è­·ã€‚', 'en': 'System maintenance will be performed on 08/15 from 02:00-04:00.'}, time: {'zh-TW': '2å¤©å‰', 'en': '2 days ago'}, unread: true },
                { id: 2, content: {'zh-TW': 'æ–°åŠŸèƒ½ä¸Šç·šï¼šèª²ç¨‹é€²åº¦è¿½è¹¤å·²æ›´æ–°ï¼', 'en': 'New Feature: Course progress tracking has been updated!'}, time: {'zh-TW': '5å¤©å‰', 'en': '5 days ago'}, unread: false },
            ],
            personal: [
                { id: 3, content: {'zh-TW': 'æ‚¨çš„ã€Œ8é€±å®Œç¾é«”æ…‹é‡å¡‘ã€èª²ç¨‹å°‡æ–¼ 10 å¤©å¾Œåˆ°æœŸã€‚', 'en': 'Your "8-Week Transformation" course expires in 10 days.'}, time: {'zh-TW': '1å°æ™‚å‰', 'en': '1 hour ago'}, unread: true },
                { id: 4, content: {'zh-TW': 'æ‚¨å·²ç¶“ä¸€é€±æ²’æœ‰ä¸Šèª²å›‰ï¼Œè¨˜å¾—å›ä¾†å‹•ä¸€å‹•ï¼', 'en': "You haven't taken a class in a week. Time to get moving!"}, time: {'zh-TW': '3å¤©å‰', 'en': '3 days ago'}, unread: false },
                { id: 10, content: {'zh-TW': 'ã€Œæ ¸å¿ƒå¼·åŒ–ã€èª²ç¨‹æœ‰æ–°çš„å­¸ç¿’è³‡æ–™ã€‚', 'en': 'New material available for "Core Strengthening" course.'}, time: {'zh-TW': '4å¤©å‰', 'en': '4 days ago'}, unread: false },
                { id: 11, content: {'zh-TW': 'æ‚¨çš„å¯†ç¢¼å·²æˆåŠŸæ›´æ–°ã€‚', 'en': 'Your password was successfully updated.'}, time: {'zh-TW': '5å¤©å‰', 'en': '5 days ago'}, unread: false },
                { id: 12, content: {'zh-TW': 'æ­¡è¿åŠ å…¥ 9\'s Pilates Studioï¼', 'en': 'Welcome to 9\'s Pilates Studio!'}, time: {'zh-TW': '1é€±å‰', 'en': '1 week ago'}, unread: false },
                { id: 13, content: {'zh-TW': 'æ‚¨çš„è¨‚å–® #20240815-001 å·²å®Œæˆã€‚', 'en': 'Your order #20240815-001 is complete.'}, time: {'zh-TW': '2é€±å‰', 'en': '2 weeks ago'}, unread: false },
                { id: 14, content: {'zh-TW': 'æé†’ï¼šæ˜å¤©æ—©ä¸Š 10:00 æœ‰é ç´„èª²ç¨‹ã€‚', 'en': 'Reminder: You have a scheduled class tomorrow at 10:00 AM.'}, time: {'zh-TW': '2é€±å‰', 'en': '2 weeks ago'}, unread: false },
                { id: 15, content: {'zh-TW': 'æœ‹å‹ Yating W. ä¹ŸåŠ å…¥äº†ã€Œç¾é«”é›•å¡‘ã€èª²ç¨‹ã€‚', 'en': 'Your friend Yating W. also joined "Body Sculpting".'}, time: {'zh-TW': '3é€±å‰', 'en': '3 weeks ago'}, unread: false },
            ]
        };

        // --- STATE ---
        let cartItems = [];
        let currentLanguage = 'zh-TW';
        let discountPercent = 0;
        let visiblePersonalNotifications = 5;

        // --- DOM ELEMENTS ---
        const cartButton = document.getElementById('cart-button'), cartPanel = document.getElementById('cart-panel'), cartBackdrop = document.getElementById('cart-backdrop'), cartCloseButton = document.getElementById('cart-close-button'), cartContent = document.getElementById('cart-content'), cartItemCountBadge = document.getElementById('cart-item-count'), menuButton = document.getElementById('menu-button'), mobileMenuPanel = document.getElementById('mobile-menu-panel'), mobileMenuBackdrop = document.getElementById('mobile-menu-backdrop'), mobileMenuCloseButton = document.getElementById('mobile-menu-close'), authModalBackdrop = document.getElementById('auth-modal-backdrop'), authModalContainer = document.getElementById('auth-modal-container'), authModalCloseBtn = document.getElementById('auth-modal-close-btn'), userIconButton = document.getElementById('user-icon-button'), footerLoginLink = document.getElementById('footer-login-link'), loginForm = document.getElementById('loginForm'), signupForm = document.getElementById('signupForm'), languageSwitcherButton = document.getElementById('language-switcher-button');
        const emptyCartView = document.getElementById('empty-cart-view');
        const checkoutView = document.getElementById('checkout-view');
        const orderSuccessView = document.getElementById('order-success-view');
        const orderSummaryItems = document.getElementById('order-summary-items');
        const priceSummaryContainer = document.getElementById('price-summary');
        const paymentForm = document.getElementById('payment-form');
        const loginPrompt = document.getElementById('login-prompt');
        const paymentFormContainer = document.getElementById('payment-form-container');
        const checkoutLoginBtn = document.getElementById('checkout-login-btn');
        const applyCouponBtn = document.getElementById('apply-coupon-btn');
        const couponInput = document.getElementById('coupon-code');
        const couponStatus = document.getElementById('coupon-status');
        const notificationButton = document.getElementById('notification-button'), notificationPanel = document.getElementById('notification-panel'), notificationDot = document.getElementById('notification-dot'), loginLogoutButton = document.getElementById('login-logout-button'), mobileLoginLogoutLink = document.getElementById('mobile-login-logout-link');
        
        // --- I18N LOGIC ---
        const t = (key) => translations[currentLanguage][key] || key;
        const updateStaticText = () => { document.title = t('page_title_checkout'); document.documentElement.lang = currentLanguage; document.querySelectorAll('[data-translate-key]').forEach(el => { const key = el.dataset.translateKey; const translation = t(key); if (el.placeholder !== undefined) { el.placeholder = translation; } else if (key === 'auth_terms_agree') { const parts = currentLanguage === 'en' ? ['I agree to the ', ' and ', ''] : ['æˆ‘åŒæ„ ', ' èˆ‡ ', '']; const termsLink = `<a href="terms.html" target="_blank" class="underline hover:text-[#b0a9a4]">${(currentLanguage === 'en' ? 'Terms of Service' : 'æœå‹™æ¢æ¬¾')}</a>`; const privacyLink = `<a href="privacy.html" target="_blank" class="underline hover:text-[#b0a9a4]">${(currentLanguage === 'en' ? 'Privacy Policy' : 'éš±ç§æ”¿ç­–')}</a>`; el.innerHTML = `${parts[0]}${termsLink}${parts[1]}${privacyLink}${parts[2]}`; } else { el.textContent = translation; } }); document.querySelectorAll('.password-toggle').forEach(btn => { const input = btn.previousElementSibling; btn.textContent = t(input.type === 'password' ? 'auth_show_password' : 'auth_hide_password'); });};
        const setLanguage = (lang) => { currentLanguage = lang; localStorage.setItem('pilatesLanguage', lang); document.getElementById('current-lang-text').textContent = lang === 'en' ? 'EN' : 'ç¹ä¸­'; updateStaticText(); renderPage(); renderNotifications();};
        const initLanguage = () => { const savedLang = localStorage.getItem('pilatesLanguage'); const lang = savedLang || (navigator.language.startsWith('en') ? 'en' : 'zh-TW'); setLanguage(lang); };

        // --- AUTH & UI LOGIC ---
        const checkLoginStatus = () => sessionStorage.getItem('isLoggedIn') === 'true';
        const openAuthModal = (view = 'login') => { document.querySelectorAll('.auth-view').forEach(v => v.classList.remove('active')); document.getElementById(`${view}View`).classList.add('active'); authModalBackdrop.classList.add('active'); authModalContainer.classList.add('active'); };
        const closeAuthModal = () => { authModalBackdrop.classList.remove('active'); authModalContainer.classList.remove('active'); const loginError = document.getElementById('login-error-message'); const signupError = document.getElementById('signup-error-message'); if(loginError) loginError.style.display = 'none'; if(signupError) signupError.style.display = 'none';};
        const updateAuthUI = (isLoggedIn) => { 
            userIconButton.classList.toggle('text-[#c1bcb8]', isLoggedIn); 
            if(loginPrompt) loginPrompt.classList.toggle('hidden', isLoggedIn);
            if(paymentFormContainer) {
                paymentFormContainer.style.opacity = isLoggedIn ? '1' : '0.5';
                paymentFormContainer.style.pointerEvents = isLoggedIn ? 'auto' : 'none';
            }
            if(isLoggedIn) {
                const user = JSON.parse(sessionStorage.getItem('user'));
                if(user && document.getElementById('name')) {
                    document.getElementById('name').value = user.name;
                    document.getElementById('email').value = user.email;
                }
            }
            loginLogoutButton.textContent = isLoggedIn ? t('logout') : t('login');
            mobileLoginLogoutLink.textContent = isLoggedIn ? t('logout') : t('login');
        };
        const handleLogout = () => { if (confirm(t('logout_confirm'))) { sessionStorage.removeItem('isLoggedIn'); sessionStorage.removeItem('user'); window.location.href = 'index.html'; }};
        const performLogin = (user) => { sessionStorage.setItem('isLoggedIn', 'true'); sessionStorage.setItem('user', JSON.stringify(user)); closeAuthModal(); updateAuthUI(true); };

        // --- CART & RENDER LOGIC ---
        const loadCart = () => { cartItems = JSON.parse(localStorage.getItem('pilatesCart') || '[]'); };
        const calculateTotals = () => { const subtotal = cartItems.reduce((acc, item) => acc + item.price * item.quantity, 0); const discountAmount = subtotal * discountPercent; const total = subtotal - discountAmount; return { subtotal, discountAmount, total }; };
        const renderPriceSummary = () => { const { subtotal, discountAmount, total } = calculateTotals(); priceSummaryContainer.innerHTML = `<div class="flex justify-between text-stone-600"><p>${t('subtotal')}</p><p>NT$ ${subtotal.toLocaleString()}</p></div><div class="flex justify-between text-red-500"><p>${t('discount')}</p><p>- NT$ ${Math.round(discountAmount).toLocaleString()}</p></div><hr class="my-2 border-dashed"><div class="flex justify-between text-stone-800 font-bold text-lg"><p>${t('total_amount')}</p><p>NT$ ${Math.round(total).toLocaleString()}</p></div>`; };
        const renderOrderSummary = () => { orderSummaryItems.innerHTML = cartItems.map(item => `<div class="flex items-center space-x-4"><img src="${item.image}" alt="${item.title[currentLanguage]}" class="w-16 h-16 object-cover rounded-md flex-shrink-0"><div class="flex-grow"><p class="font-semibold text-sm">${item.title[currentLanguage]}</p><p class="text-xs text-stone-500">${item.quantity} x NT$ ${item.price.toLocaleString()}</p></div><p class="font-semibold text-sm">NT$ ${(item.quantity * item.price).toLocaleString()}</p></div>`).join(''); };
        const renderPage = () => { loadCart(); if (cartItems.length === 0 && !orderSuccessView.classList.contains('block')) { checkoutView.classList.add('hidden'); emptyCartView.classList.remove('hidden'); } else if (!orderSuccessView.classList.contains('block')) { emptyCartView.classList.add('hidden'); checkoutView.classList.remove('hidden'); renderOrderSummary(); renderPriceSummary(); updateAuthUI(checkLoginStatus()); } };
        
        // --- Notification Logic ---
        const renderNotifications = () => {
            const singleItemHTML = (n) => `
                <a href="#" class="notification-item ${n.unread ? 'unread' : ''}">
                    <p>${n.content[currentLanguage]}</p>
                    <time>${n.time[currentLanguage]}</time>
                </a>
            `;
            // Announcements
            const announcementsContainer = document.getElementById('latest-announcement-container');
            const allAnnouncements = dummyNotifications.announcements;
            document.getElementById('announcements-count').textContent = allAnnouncements.length;
            if (allAnnouncements.length > 0) {
                announcementsContainer.innerHTML = singleItemHTML(allAnnouncements[0]);
            } else {
                announcementsContainer.innerHTML = `<div class="p-4 text-center text-sm text-stone-500">${t('notifications_no_items')}</div>`;
            }
            // Personal Notifications
            const personalList = document.getElementById('personal-notifications-list');
            const loadMoreBtn = document.getElementById('load-more-notifications');
            const allPersonal = dummyNotifications.personal;
            const visibleItems = allPersonal.slice(0, visiblePersonalNotifications);
            if (visibleItems.length > 0) {
                personalList.innerHTML = visibleItems.map(singleItemHTML).join('');
            } else {
                personalList.innerHTML = `<div class="p-4 text-center text-sm text-stone-500">${t('notifications_no_items')}</div>`;
            }
            if (allPersonal.length > visiblePersonalNotifications) {
                loadMoreBtn.classList.remove('hidden');
            } else {
                loadMoreBtn.classList.add('hidden');
            }
            // Unread dot
            const hasUnread = [...allAnnouncements, ...allPersonal].some(n => n.unread);
            notificationDot.classList.toggle('hidden', !hasUnread);
        };

        // --- EVENT LISTENERS ---
        checkoutLoginBtn.addEventListener('click', () => openAuthModal('login'));
        applyCouponBtn.addEventListener('click', () => { const code = couponInput.value.trim().toUpperCase(); if (code === 'PILATES2025') { discountPercent = 0.15; couponStatus.textContent = t('coupon_applied'); couponStatus.className = 'text-xs text-center h-4 text-green-600'; } else { discountPercent = 0; couponStatus.textContent = t('invalid_coupon'); couponStatus.className = 'text-xs text-center h-4 text-red-500'; } renderPriceSummary(); });
        if(paymentForm) paymentForm.addEventListener('submit', (e) => { e.preventDefault(); checkoutView.classList.add('hidden'); orderSuccessView.classList.remove('hidden'); document.getElementById('checkout-page').scrollIntoView(); localStorage.removeItem('pilatesCart'); updateCartCount(); window.scrollTo(0, 0); });
        
        // --- Common Listeners ---
        const openCart = () => { cartPanel.classList.remove('translate-x-full'); cartBackdrop.classList.remove('opacity-0', 'pointer-events-none'); };
        const closeCart = () => { cartPanel.classList.add('translate-x-full'); cartBackdrop.classList.add('opacity-0', 'pointer-events-none'); };
        const updateCartCount = () => { const c = JSON.parse(localStorage.getItem('pilatesCart')||'[]'); const t = c.reduce((s, i) => s + (i.quantity || 1), 0); cartItemCountBadge.textContent = t; cartItemCountBadge.classList.toggle('hidden', t === 0); };
        cartButton.addEventListener('click', openCart); cartCloseButton.addEventListener('click', closeCart); cartBackdrop.addEventListener('click', closeCart);
        const openMobileMenu = () => { mobileMenuPanel.classList.remove('-translate-x-full'); mobileMenuBackdrop.classList.remove('opacity-0', 'pointer-events-none'); };
        const closeMobileMenu = () => { mobileMenuPanel.classList.add('-translate-x-full'); mobileMenuBackdrop.classList.add('opacity-0', 'pointer-events-none'); };
        menuButton.addEventListener('click', openMobileMenu); mobileMenuCloseButton.addEventListener('click', closeMobileMenu); mobileMenuBackdrop.addEventListener('click', closeMobileMenu);
        userIconButton.addEventListener('click', () => { if(checkLoginStatus()) window.location.href = 'dashboard.html'; else openAuthModal(); });
        footerLoginLink.addEventListener('click', (e) => { e.preventDefault(); if (checkLoginStatus()) alert(t('already_logged_in')); else openAuthModal(); });
        authModalBackdrop.addEventListener('click', closeAuthModal); authModalCloseBtn.addEventListener('click', closeAuthModal);
        document.querySelectorAll('.auth-view-switch').forEach(link => { link.addEventListener('click', (e) => { e.preventDefault(); openAuthModal(e.target.closest('[data-view]').dataset.view); }); });
        loginForm.addEventListener('submit', (e) => { e.preventDefault(); const email = loginForm.querySelector('input[type="email"]').value; const password = loginForm.querySelector('input[type="password"]').value; const err = document.getElementById('login-error-message'); if (email === 'test@example.com' && password === 'password123') { err.style.display = 'none'; performLogin({ name: 'æ¸¬è©¦ä½¿ç”¨è€…', email: 'test@example.com' }); } else { err.textContent = t('auth_login_error'); err.style.display = 'block'; } });
        signupForm.addEventListener('submit', (e) => { e.preventDefault(); const nameInput = signupForm.querySelector('input[type="text"]'); const emailInput = signupForm.querySelector('input[type="email"]'); const passwordInput = signupForm.querySelectorAll('input[type="password"]')[0]; const confirmPasswordInput = signupForm.querySelectorAll('input[type="password"]')[1]; const errorMessage = document.getElementById('signup-error-message'); if (passwordInput.value !== confirmPasswordInput.value) { errorMessage.textContent = t('auth_passwords_no_match'); errorMessage.style.display = 'block'; return; } errorMessage.style.display = 'none'; performLogin({ name: nameInput.value, email: emailInput.value }); });
        languageSwitcherButton.addEventListener('click', () => setLanguage(currentLanguage === 'en' ? 'zh-TW' : 'en'));
        loginLogoutButton.addEventListener('click', () => { if (checkLoginStatus()) { handleLogout(); } else { openAuthModal(); }});
        mobileLoginLogoutLink.addEventListener('click', (e) => { e.preventDefault(); if (checkLoginStatus()) { handleLogout(); } else { closeMobileMenu(); openAuthModal(); }});

        notificationButton.addEventListener('click', (e) => { e.stopPropagation(); notificationPanel.classList.toggle('hidden'); });
        document.addEventListener('click', (e) => { if (!notificationPanel.contains(e.target) && !notificationButton.contains(e.target)) { notificationPanel.classList.add('hidden'); }});
        document.getElementById('load-more-notifications').addEventListener('click', () => {
            visiblePersonalNotifications += 5;
            renderNotifications();
        });

        // --- INITIALIZATION ---
        initLanguage();
        updateCartCount();

    });
    </script>
</body>
</html>
