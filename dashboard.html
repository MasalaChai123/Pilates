<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>我的課程 - 9's Pilates Studio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
      html {
        scroll-behavior: smooth;
      }
      body {
        font-family: 'Noto Sans TC', sans-serif;
        background-color: #efefef;
        color: #292524; /* text-stone-800 */
      }
      .font-serif {
        font-family: 'Playfair Display', serif;
      }
      .transform { transition: transform 0.3s ease-in-out; }
      .opacity-transition { transition: opacity 0.3s ease-in-out; }
      .tab.active {
        border-color: #c1bcb8;
        color: #c1bcb8;
      }
      .tab-content { display: none; }
      .tab-content.active { display: block; }
    </style>
     <style id="auth-modal-styles">
        /* Modal Container */
        .auth-modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease-out;
            pointer-events: none;
        }
        .auth-modal-backdrop.active {
            opacity: 1;
            pointer-events: auto;
        }
        .auth-modal-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            z-index: 1001;
            opacity: 0;
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
            pointer-events: none;
            width: 100%;
            max-width: 450px;
            padding: 20px;
            max-height: 95vh;
            overflow-y: auto;
        }
        .auth-modal-container.active {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            pointer-events: auto;
        }

        /* Auth Card Styles from user */
        .auth-card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            width: 100%;
            position: relative;
            overflow: hidden;
        }
        .auth-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #d1cfcd, #c1bcb8, #d1cfcd);
        }
        .auth-header { text-align: center; margin-bottom: 30px; }
        .auth-title { font-size: 28px; font-weight: 700; margin-bottom: 8px; background: linear-gradient(135deg, #333, #555); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .auth-subtitle { color: #666; font-size: 14px; }
        .form-group { margin-bottom: 20px; position: relative; }
        .form-label { display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 14px; }
        .form-control { width: 100%; padding: 15px 20px; border: 2px solid #e8e8e8; border-radius: 12px; font-size: 16px; transition: all 0.3s ease; background: rgba(255, 255, 255, 0.8); }
        .form-control:focus { outline: none; border-color: #c1bcb8; box-shadow: 0 0 0 4px rgba(193, 188, 184, 0.1); background: white; }
        .password-field { position: relative; }
        .password-toggle { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); background: none; border: none; color: #666; cursor: pointer; font-size: 14px; padding: 5px; }
        .checkbox-group { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; }
        .checkbox { width: 18px; height: 18px; accent-color: #c1bcb8; }
        .checkbox-label { font-size: 14px; color: #666; flex: 1; }
        .checkbox-label a { color: #c1bcb8; text-decoration: underline; }
        .checkbox-label a:hover { color: #b0a9a4; }
        .btn { display: inline-flex; align-items: center; justify-content: center; padding: 15px 24px; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; text-decoration: none; gap: 8px; width: 100%; }
        .btn-primary { background: linear-gradient(135deg, #c1bcb8, #b0a9a4); color: white; box-shadow: 0 8px 25px rgba(193, 188, 184, 0.3); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 12px 35px rgba(193, 188, 184, 0.4); }
        .social-buttons { margin-top: 20px; }
        .btn-social { background: white; border: 2px solid #e8e8e8; color: #666; margin-bottom: 12px; font-weight: 500; }
        .btn-social:hover { border-color: #c1bcb8; color: #c1bcb8; background: rgba(193, 188, 184, 0.1); }
        .btn-social span { display: flex; align-items: center; justify-content: center; gap: 10px; width: 100%; }
        .btn-social svg { width: 20px; height: 20px; }
        .divider { text-align: center; margin: 25px 0; position: relative; color: #999; font-size: 14px; }
        .divider::before { content: ''; position: absolute; top: 50%; left: 0; right: 0; height: 1px; background: #e8e8e8; z-index: 0; }
        .divider span { background: #fff; padding: 0 15px; position: relative; z-index: 1; }
        .auth-switch { text-align: center; margin-top: 25px; padding-top: 25px; border-top: 1px solid #e8e8e8; color: #666; font-size: 14px; }
        .auth-switch a { color: #c1bcb8; font-weight: 600; text-decoration: none; cursor: pointer; }
        .forgot-password { text-align: center; margin-top: 15px; }
        .forgot-password a { color: #c1bcb8; font-size: 14px; text-decoration: none; cursor: pointer; }
        .auth-view { display: none; animation: fadeIn 0.3s ease-out; }
        .auth-view.active { display: block; }
        .back-link { display: inline-flex; align-items: center; gap: 5px; color: #c1bcb8; font-size: 14px; margin-bottom: 20px; cursor: pointer; }
        .success-message { background: linear-gradient(135deg, #00b894, #00a085); color: white; padding: 15px 20px; border-radius: 12px; margin-bottom: 20px; text-align: center; font-weight: 500; display: none; }
        .success-message.show { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .auth-modal-close-btn { position: absolute; top: 15px; right: 15px; background: none; border: none; cursor: pointer; color: #999; font-size: 24px; line-height: 1; padding: 5px; }
        .auth-modal-close-btn:hover { color: #333; }
        @media (max-width: 480px) {
            .auth-card { padding: 25px 20px; }
            .auth-title { font-size: 22px; }
        }
    </style>
</head>
<body class="bg-[#efefef] text-stone-800">

    <!-- Header -->
    <header class="sticky top-0 bg-[#f9f9f9]/80 backdrop-blur-md z-40 shadow-sm">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-20">
          <div class="flex-shrink-0">
            <a href="index.html" class="flex items-center space-x-2">
               <img class="h-10 w-auto" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMDAiIGhlaWdodD0iNzgiIHZpZXdCb3g9IjAgMCAzMDAgNzgiPjxzdHlsZT4ud2VpZ2h0LTkwMCB7IGZvbnQtd2VpZ2h0OiA5MDA7IH0gLmN1cnNpdmUgeyBmb250LWZhbWlseTogJ1BsYXlmYWlyIERpc3BsYXksIHNlcmlmJzsgZm9udC1zdHlsZTogaXRhbGljOyB9IC5zZXJpZiB7IGZvbnQtZmFtaWx5OiAnUGxheWZhaXIgRGlzcGxheScsIHNlcmlmOyB9PC9zdHlsZT48dGV4dCB4PSIxMCIgeT0iNzAiIGZvbnQtZmFtaWx5PSJQbGF5ZmFpciBEaXNwbGF5LCBzZXJpZiIgZm9udC1zaXplPSI5MCIgZmlsbD0iIzAwMCI+PXRzcGFuIHg9IjEwIiBkeT0iMCIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjIiPkY8L3RzcGFuPjx0c3BhbiB4PSI0OCIgZHk9IjAiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLXdpZHRoPSIxIj5GOy90c3Bhbj48L3RleHQ+PHRleHQgeD0iMTA1IiB5PSI1MiIgc3R5bGU9ImZvbnQtZmFtaWx5OiAnUGxheWZhaXIgRGlzcGxheScsIHNlcmlmOyBmb250LXNpemU6IDI4cHc7IGxldHRlci1zcGFjaW5nOiAycHg7Ij48dHNwYW4geD0iMTA1IiBkeT0iMCIgY2xhc3M9ImN1cnNpdmUiPjwnczwvdHNwYW4+PHRzcGFuIHg9IjE0MCIgZHk9IiI+IFBJTFRFUzwvdHNwYW4+PC90ZXh0Pjwvc3ZnPg==" alt="9's Pilates Logo" />
            </a>
          </div>
          <nav class="hidden lg:flex lg:items-center lg:space-x-8">
            <a href="index.html#single-session" class="text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_single_session">單堂體驗</a>
            <a href="index.html#thematic-unit" class="text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_thematic_unit">主題單元</a>
            <a href="index.html#sculpting-plan" class="text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_sculpting_plan">體態雕塑</a>
            <a href="#" class="text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_faq">常見問題</a>
          </nav>
          <div class="flex items-center space-x-4">
            <button id="language-switcher-button" class="text-stone-600 hover:text-[#c1bcb8] transition-colors flex items-center space-x-1" aria-label="Switch language">
                <i class="fas fa-globe"></i>
                <span id="current-lang-text" class="text-sm font-medium">繁中</span>
            </button>
             <button id="user-icon-button" class="relative text-stone-600 hover:text-[#c1bcb8] transition-colors" aria-label="User account">
                <i aria-hidden="true" class="fas fa-user text-xl"></i> 
             </button>
            <button id="cart-button" class="relative text-stone-600 hover:text-[#c1bcb8] transition-colors" aria-label="Open shopping cart">
              <i aria-hidden="true" class="fas fa-shopping-cart text-xl"></i>
              <span id="cart-item-count" class="absolute -top-2 -right-2 flex h-5 w-5 items-center justify-center rounded-full bg-[#c1bcb8] text-xs font-medium text-white hidden">0</span>
            </button>
            <button id="menu-button" class="lg:hidden text-stone-600 hover:text-[#c1bcb8] transition-colors" aria-label="Open menu">
              <i aria-hidden="true" class="fas fa-bars text-xl"></i>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Mobile Menu -->
    <div id="mobile-menu-backdrop" class="fixed inset-0 bg-black bg-opacity-50 z-40 opacity-transition opacity-0 pointer-events-none lg:hidden"></div>
    <div id="mobile-menu-panel" class="fixed top-0 left-0 h-full w-64 bg-white shadow-2xl z-50 transform -translate-x-full lg:hidden">
        <div class="flex flex-col h-full">
            <div class="flex items-center justify-between p-6 border-b border-stone-200">
                <h2 class="text-xl font-semibold text-stone-800" data-translate-key="mobile_menu_title">選單</h2>
                <button id="mobile-menu-close" class="text-stone-500 hover:text-stone-800 transition-colors">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <nav class="flex-grow p-6">
                <ul class="space-y-4">
                    <li><a href="index.html#single-session" class="mobile-menu-link block py-2 text-lg text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_single_session">單堂體驗</a></li>
                    <li><a href="index.html#thematic-unit" class="mobile-menu-link block py-2 text-lg text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_thematic_unit">主題單元</a></li>
                    <li><a href="index.html#sculpting-plan" class="mobile-menu-link block py-2 text-lg text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_sculpting_plan">體態雕塑</a></li>
                    <li><a href="#" class="mobile-menu-link block py-2 text-lg text-stone-600 hover:text-[#c1bcb8] transition-colors" data-translate-key="nav_faq">常見問題</a></li>
                </ul>
            </nav>
        </div>
    </div>

    <!-- Shopping Cart -->
    <div id="cart-backdrop" class="fixed inset-0 bg-black bg-opacity-50 z-40 opacity-transition opacity-0 pointer-events-none"></div>
    <div id="cart-panel" class="fixed top-0 right-0 h-full w-full max-w-md bg-white shadow-2xl z-50 transform translate-x-full">
        <div class="flex flex-col h-full">
            <div class="flex items-center justify-between p-6 border-b border-stone-200">
                <h2 class="text-xl font-semibold text-stone-800" data-translate-key="cart_title">購物車</h2>
                <button id="cart-close-button" class="text-stone-500 hover:text-stone-800 transition-colors">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div id="cart-content" class="flex-grow">
                <!-- Cart items will be injected here -->
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div id="auth-modal-backdrop" class="auth-modal-backdrop"></div>
    <div id="auth-modal-container" class="auth-modal-container">
        <div class="auth-card">
            <button id="auth-modal-close-btn" class="auth-modal-close-btn">&times;</button>
            <!-- Login View -->
            <div id="loginView" class="auth-view active">
                <div class="auth-header">
                    <h1 class="auth-title" data-translate-key="auth_login_title">會員登入</h1>
                    <p class="auth-subtitle" data-translate-key="auth_login_subtitle">登入開始您的皮拉提斯之旅</p>
                </div>
                <form id="loginForm">
                    <div class="form-group">
                        <label class="form-label" data-translate-key="auth_email_label">電子郵件</label>
                        <input type="email" class="form-control" placeholder="輸入您的電子郵件" data-translate-key="auth_email_placeholder" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" data-translate-key="auth_password_label">密碼</label>
                        <div class="password-field">
                            <input type="password" class="form-control password-input" placeholder="輸入您的密碼" data-translate-key="auth_password_placeholder" required>
                            <button type="button" class="password-toggle" data-translate-key="auth_show_password">顯示</button>
                        </div>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="remember" class="checkbox">
                        <label for="remember" class="checkbox-label" data-translate-key="auth_remember_me">記住我</label>
                    </div>
                    <button type="submit" class="btn btn-primary" data-translate-key="auth_login_button">登入</button>
                    <div class="forgot-password"><a class="auth-view-switch" data-view="forgotPassword" data-translate-key="auth_forgot_password">忘記密碼？</a></div>
                </form>
                <div class="divider"><span data-translate-key="auth_or">或</span></div>
                <div class="social-buttons">
                    <button type="button" class="btn btn-social"><span><svg viewBox="0 0 24 24" fill="#666"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg><span data-translate-key="auth_google_login">使用 Google 登入</span></span></button>
                    <button type="button" class="btn btn-social"><span><svg viewBox="0 0 24 24" fill="#666"><path d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.627-.63.349 0 .631.285.631.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.349 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.282.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"/></svg><span data-translate-key="auth_line_login">使用 LINE 登入</span></span></button>
                </div>
                <div class="auth-switch"><span data-translate-key="auth_no_account">還沒有帳號？</span> <a class="auth-view-switch" data-view="signup" data-translate-key="auth_signup_now">立即註冊</a></div>
            </div>
            <!-- Sign Up View -->
            <div id="signupView" class="auth-view">
                <div class="auth-header"><h1 class="auth-title" data-translate-key="auth_signup_title">建立帳號</h1><p class="auth-subtitle" data-translate-key="auth_signup_subtitle">加入 9's Pilates 開始您的健康之旅</p></div>
                <form id="signupForm">
                    <div class="form-group"><label class="form-label" data-translate-key="auth_name_label">姓名</label><input type="text" class="form-control" placeholder="輸入您的姓名" data-translate-key="auth_name_placeholder" required></div>
                    <div class="form-group"><label class="form-label" data-translate-key="auth_email_label">電子郵件</label><input type="email" class="form-control" placeholder="輸入您的電子郵件" data-translate-key="auth_email_placeholder" required></div>
                    <div class="form-group"><label class="form-label" data-translate-key="auth_password_label">密碼</label><div class="password-field"><input type="password" class="form-control password-input" placeholder="至少8個字元" data-translate-key="auth_password_placeholder_signup" required><button type="button" class="password-toggle" data-translate-key="auth_show_password">顯示</button></div></div>
                    <div class="form-group"><label class="form-label" data-translate-key="auth_confirm_password_label">確認密碼</label><div class="password-field"><input type="password" class="form-control password-input" placeholder="再次輸入密碼" data-translate-key="auth_confirm_password_placeholder" required><button type="button" class="password-toggle" data-translate-key="auth_show_password">顯示</button></div></div>
                    <div class="checkbox-group"><input type="checkbox" id="terms" class="checkbox" required><label for="terms" class="checkbox-label" data-translate-key="auth_terms_agree">我同意 <a>服務條款</a> 與 <a>隱私政策</a></label></div>
                    <button type="submit" class="btn btn-primary" data-translate-key="auth_create_account_button">建立帳號</button>
                </form>
                <div class="auth-switch"><span data-translate-key="auth_already_have_account">已經有帳號？</span> <a class="auth-view-switch" data-view="login" data-translate-key="auth_login_now">立即登入</a></div>
            </div>
            <!-- Forgot Password View -->
            <div id="forgotPasswordView" class="auth-view">
                <a class="back-link auth-view-switch" data-view="login"><span class="mr-1">←</span> <span data-translate-key="auth_back_to_login">返回登入</span></a>
                <div class="auth-header"><h1 class="auth-title" data-translate-key="auth_forgot_password_title">忘記密碼</h1><p class="auth-subtitle" data-translate-key="auth_forgot_password_subtitle">輸入您的電子郵件，我們會發送密碼重設連結給您</p></div>
                <div id="forgotPasswordSuccess" class="success-message" data-translate-key="auth_forgot_password_success">重設密碼連結已發送至您的信箱！</div>
                <form id="forgotPasswordForm">
                    <div class="form-group"><label class="form-label" data-translate-key="auth_email_label">電子郵件</label><input type="email" class="form-control" placeholder="輸入您註冊的電子郵件" data-translate-key="auth_registered_email_placeholder" required></div>
                    <button type="submit" class="btn btn-primary" data-translate-key="auth_send_reset_link_button">發送重設連結</button>
                </form>
            </div>
        </div>
    </div>

    <main>
        <!-- Dashboard Header -->
        <section class="bg-[#eae5da] py-8">
            <div id="dashboard-header-container" class="container mx-auto px-4 sm:px-6 lg:px-8">
                <!-- User info will be injected here -->
            </div>
        </section>

        <!-- Dashboard Tabs -->
        <div class="bg-white border-b border-stone-200 sticky top-20 z-30">
            <div id="dashboard-tabs" class="container mx-auto px-4 sm:px-6 lg:px-8 flex space-x-4 sm:space-x-8 -mb-px overflow-x-auto">
                 <button class="tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-stone-500 hover:text-[#c1bcb8] hover:border-[#c1bcb8] transition-colors" data-tab="my-courses" data-translate-key="tab_my_courses">我的課程</button>
                 <button class="tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-stone-500 hover:text-[#c1bcb8] hover:border-[#c1bcb8] transition-colors" data-tab="favorites" data-translate-key="tab_favorites">收藏</button>
                 <button class="tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-stone-500 hover:text-[#c1bcb8] hover:border-[#c1bcb8] transition-colors" data-tab="history" data-translate-key="tab_history">觀看紀錄</button>
                 <button class="tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-stone-500 hover:text-[#c1bcb8] hover:border-[#c1bcb8] transition-colors" data-tab="settings" data-translate-key="tab_settings">帳號設定</button>
            </div>
        </div>
        
        <!-- Dashboard Content -->
        <section class="py-8 md:py-12">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <!-- My Courses Content -->
                <div id="my-courses-content" class="tab-content">
                    <!-- Content will be injected by JS -->
                </div>
                
                <!-- Favorites Content -->
                <div id="favorites-content" class="tab-content">
                    <!-- Empty state or content will be injected -->
                </div>

                <!-- History Content -->
                <div id="history-content" class="tab-content">
                    <!-- Empty state or content will be injected -->
                </div>

                <!-- Settings Content -->
                <div id="settings-content" class="tab-content">
                    <!-- Content will be injected by JS -->
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-stone-800 text-stone-300">
        <div class="container mx-auto py-12 px-4 sm:px-6 lg:px-8 text-center">
            <img class="h-12 w-auto mx-auto mb-4" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMDAiIGhlaWdodD0iNzgiIHZpZXdCb3g9IjAgMCAzMDAgNzgiPjxzdHlsZT4ud2VpZ2h0LTkwMCB7IGZvbnQtd2VpZ2h0OiA5MDA7IH0gLmN1cnNpdmUgeyBmb250LWZhbWlseTogJ1BsYXlmYWlyIERpc3BsYXksIHNlcmlmJzsgZm9udC1zdHlsZTogaXRhbGljOyB9IC5zZXJpZiB7IGZvbnQtZmFtaWx5OiAnUGxheWZhaXIgRGlzcGxheScsIHNlcmlmOyB9PC9zdHlsZT48dGV4dCB4PSIxMCIgeT0iNzAiIGZvbnQtZmFtaWx5PSJQbGF5ZmFpciBEaXNwbGF5LCBzZXJpZiIgZm9udC1zaXplPSI5MCIgZmlsbD0iI2ZmZiI+PXRzcGFuIHg9IjEwIiBkeT0iMCIgc3Ryb2tlPSIjZmZmIiBzdHJva2Utd2lkdGg9IjIiPkY8L3RzcGFuPjx0c3BhbiB4PSI0OCIgZHk9IjAiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxIj5GOy90c3Bhbj48L3RleHQ+PHRleHQgeD0iMTA1IiB5PSI1MiIgc3R5bGU9ImZvbnQtZmFtaWx5OiAnUGxheWZhaXIgRGlzcGxheScsIHNlcmlmOyBmb250LXNpemU6IDI4cHc7IGxldHRlci1zcGFjaW5nOiAycHg7IGZpbGw6ICNmZmY7Ij48dHNwYW4geD0iMTA1IiBkeT0iMCIgY2xhc3M9ImN1cnNpdmUiPjwnczwvdHNwYW4+PHRzcGFuIHg9IjE0MCIgZHk9IiI+IFBJTFRFUzwvdHNwYW4+PC90ZXh0Pjwvc3ZnPg==" alt="9's Pilates" />
            <div class="flex justify-center space-x-6 my-6">
                <a href="index.html" class="hover:text-white transition-colors" data-translate-key="footer_all_courses">所有課程</a>
                <a href="#" class="hover:text-white transition-colors" data-translate-key="nav_faq">常見問題</a>
                <a href="#" id="footer-login-link" class="hover:text-white transition-colors" data-translate-key="footer_member_login">會員登入</a>
            </div>
            <p class="my-4">
                <a href="mailto:9spilates@gmail.com" class="hover:text-white transition-colors"><span data-translate-key="footer_contact_email">客服信箱</span>：9spilates@gmail.com</a>
            </p>
            <div class="flex justify-center space-x-6 my-6">
                 <a href="#" class="text-stone-400 hover:text-white transition-colors" aria-label="Instagram">
                    <i class="fab fa-instagram text-2xl"></i>
                </a>
                <a href="#" class="text-stone-400 hover:text-white transition-colors" aria-label="Line">
                    <i class="fab fa-line text-2xl"></i>
                </a>
            </div>
            <p class="text-sm text-stone-400" data-translate-key="footer_copyright">© 2025 9's Pilates. 版權所有</p>
            <div class="flex justify-center space-x-4 mt-2 text-xs text-stone-500">
                <a href="terms.html" class="hover:text-stone-300 transition-colors" data-translate-key="footer_terms">使用條款</a>
                <span>|</span>
                <a href="privacy.html" class="hover:text-stone-300 transition-colors" data-translate-key="footer_privacy">隱私政策</a>
            </div>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- TRANSLATIONS ---
        const translations = {
            'en': {
                'page_title_dashboard': "My Courses - 9's Pilates Studio",
                'nav_single_session': 'Single Session',
                'nav_thematic_unit': 'Thematic Unit',
                'nav_sculpting_plan': 'Body Sculpting',
                'nav_faq': 'FAQ',
                'mobile_menu_title': 'Menu',
                'cart_title': 'Shopping Cart',
                'cart_empty': 'Your cart is empty',
                'cart_continue_shopping': 'Continue Shopping',
                'cart_subtotal': 'Subtotal',
                'cart_checkout': 'Checkout',
                'footer_all_courses': 'All Courses',
                'footer_member_login': 'Member Login',
                'footer_contact_email': 'Contact Email',
                'footer_copyright': '© 2025 9\'s Pilates. All Rights Reserved',
                'footer_terms': 'Terms of Use',
                'footer_privacy': 'Privacy Policy',
                'logout_confirm': 'Are you sure you want to log out?',
                'already_logged_in': 'You are already logged in.',
                // Dashboard
                'dashboard_greeting': 'Hello, ${userName}',
                'membership_status': 'Membership Status',
                'tab_my_courses': 'My Courses',
                'tab_favorites': 'Favorites',
                'tab_history': 'History',
                'tab_settings': 'Settings',
                'course_progress': 'Progress: ${progress}%',
                'valid_until': 'Expires:',
                'start_course': 'Start Course',
                'continue_course': 'Continue',
                'view_details': 'Details',
                'empty_courses_title': 'You Have No Courses Yet',
                'empty_courses_subtitle': 'It looks like you haven\'t enrolled in any courses. Explore our catalog to start your Pilates journey!',
                'more_courses_title': 'Ready for Your Next Challenge?',
                'more_courses_subtitle': 'Expand your practice and discover new ways to move. There\'s always something new to learn.',
                'empty_favorites_title': 'No Favorites Yet',
                'empty_favorites_subtitle': 'Add courses to your favorites for easy access.',
                'empty_history_title': 'No Watch History',
                'empty_history_subtitle': 'Your recently watched courses will appear here.',
                'browse_courses': 'Browse All Courses',
                'settings_title': 'Account Information',
                'settings_name': 'Name',
                'settings_email': 'Email',
                'settings_password': 'Password',
                'settings_change_password': 'Change Password',
                'settings_save': 'Save Changes',
                'settings_logout': 'Log Out',
                'settings_logout_confirm': 'Are you sure you want to log out?',
                'settings_saved_success': 'Your changes have been saved.',
                'unauthorized_access': 'You must be logged in to view this page.',
                'redirecting_home': 'Redirecting to homepage...',
                // Auth Modal
                'auth_login_title': 'Member Login',
                'auth_login_subtitle': 'Log in to begin your Pilates journey',
                'auth_email_label': 'Email',
                'auth_email_placeholder': 'Enter your email',
                'auth_password_label': 'Password',
                'auth_password_placeholder': 'Enter your password',
                'auth_show_password': 'Show',
                'auth_hide_password': 'Hide',
                'auth_remember_me': 'Remember me',
                'auth_login_button': 'Log In',
                'auth_forgot_password': 'Forgot password?',
                'auth_or': 'or',
                'auth_google_login': 'Sign in with Google',
                'auth_line_login': 'Sign in with LINE',
                'auth_no_account': 'Don\'t have an account?',
                'auth_signup_now': 'Sign up now',
                'auth_signup_title': 'Create Account',
                'auth_signup_subtitle': 'Join 9\'s Pilates to start your wellness journey',
                'auth_name_label': 'Name',
                'auth_name_placeholder': 'Enter your name',
                'auth_password_placeholder_signup': 'At least 8 characters',
                'auth_confirm_password_label': 'Confirm Password',
                'auth_confirm_password_placeholder': 'Enter password again',
                'auth_terms_agree': 'I agree to the <a>Terms of Service</a> and <a>Privacy Policy</a>',
                'auth_create_account_button': 'Create Account',
                'auth_already_have_account': 'Already have an account?',
                'auth_login_now': 'Log in now',
                'auth_back_to_login': 'Back to login',
                'auth_forgot_password_title': 'Forgot Password',
                'auth_forgot_password_subtitle': 'Enter your email and we\'ll send you a reset link',
                'auth_forgot_password_success': 'A password reset link has been sent to your email!',
                'auth_registered_email_placeholder': 'Enter your registered email',
                'auth_send_reset_link_button': 'Send Reset Link',
            },
            'zh-TW': {
                'page_title_dashboard': "我的課程 - 9's Pilates Studio",
                'nav_single_session': '單堂體驗',
                'nav_thematic_unit': '主題單元',
                'nav_sculpting_plan': '體態雕塑',
                'nav_faq': '常見問題',
                'mobile_menu_title': '選單',
                'cart_title': '購物車',
                'cart_empty': '您的購物車是空的',
                'cart_continue_shopping': '繼續選購',
                'cart_subtotal': '小計',
                'cart_checkout': '前往結帳',
                'footer_all_courses': '所有課程',
                'footer_member_login': '會員登入',
                'footer_contact_email': '客服信箱',
                'footer_copyright': '© 2025 9\'s Pilates. 版權所有',
                'footer_terms': '使用條款',
                'footer_privacy': '隱私政策',
                'logout_confirm': '您確定要登出嗎？',
                'already_logged_in': '您已經登入。',
                // Dashboard
                'dashboard_greeting': '哈囉，${userName}',
                'membership_status': '會員資格',
                'tab_my_courses': '我的課程',
                'tab_favorites': '收藏',
                'tab_history': '觀看紀錄',
                'tab_settings': '帳號設定',
                'course_progress': '進度: ${progress}%',
                'valid_until': '有效期至:',
                'start_course': '開始上課',
                'continue_course': '繼續觀看',
                'view_details': '課程詳情',
                'empty_courses_title': '您尚未購買任何課程',
                'empty_courses_subtitle': '看起來您還沒有任何課程。立即探索我們的課程，開始您的皮拉提斯之旅吧！',
                'more_courses_title': '準備好迎接下一個挑戰了嗎？',
                'more_courses_subtitle': '拓展您的練習，探索新的動作方式。總有新的知識等著您來學習。',
                'empty_favorites_title': '尚無收藏課程',
                'empty_favorites_subtitle': '將您喜歡的課程加入收藏，方便日後查找。',
                'empty_history_title': '尚無觀看紀錄',
                'empty_history_subtitle': '您最近觀看的課程將會顯示在這裡。',
                'browse_courses': '瀏覽所有課程',
                'settings_title': '帳戶資訊',
                'settings_name': '姓名',
                'settings_email': '電子郵件',
                'settings_password': '密碼',
                'settings_change_password': '更改密碼',
                'settings_save': '儲存變更',
                'settings_logout': '登出帳號',
                'settings_logout_confirm': '您確定要登出嗎？',
                'settings_saved_success': '您的變更已成功儲存。',
                'unauthorized_access': '您必須登入才能查看此頁面。',
                'redirecting_home': '正在將您導回首頁...',
                // Auth Modal
                'auth_login_title': '會員登入',
                'auth_login_subtitle': '登入開始您的皮拉提斯之旅',
                'auth_email_label': '電子郵件',
                'auth_email_placeholder': '輸入您的電子郵件',
                'auth_password_label': '密碼',
                'auth_password_placeholder': '輸入您的密碼',
                'auth_show_password': '顯示',
                'auth_hide_password': '隱藏',
                'auth_remember_me': '記住我',
                'auth_login_button': '登入',
                'auth_forgot_password': '忘記密碼？',
                'auth_or': '或',
                'auth_google_login': '使用 Google 登入',
                'auth_line_login': '使用 LINE 登入',
                'auth_no_account': '還沒有帳號？',
                'auth_signup_now': '立即註冊',
                'auth_signup_title': '建立帳號',
                'auth_signup_subtitle': '加入 9\'s Pilates 開始您的健康之旅',
                'auth_name_label': '姓名',
                'auth_name_placeholder': '輸入您的姓名',
                'auth_password_placeholder_signup': '至少8個字元',
                'auth_confirm_password_label': '確認密碼',
                'auth_confirm_password_placeholder': '再次輸入密碼',
                'auth_terms_agree': '我同意 <a>服務條款</a> 與 <a>隱私政策</a>',
                'auth_create_account_button': '建立帳號',
                'auth_already_have_account': '已經有帳號？',
                'auth_login_now': '立即登入',
                'auth_back_to_login': '返回登入',
                'auth_forgot_password_title': '忘記密碼',
                'auth_forgot_password_subtitle': '輸入您的電子郵件，我們會發送密碼重設連結給您',
                'auth_forgot_password_success': '重設密碼連結已發送至您的信箱！',
                'auth_registered_email_placeholder': '輸入您註冊的電子郵件',
                'auth_send_reset_link_button': '發送重設連結',
            }
        };
        
        // --- MOCK DATA ---
        const dashboardData = {
            user: {
                name: "吳小姐",
                email: "example.user@email.com",
                membership: {
                    'zh-TW': "半年會員 (有效期至: 2025/10/07)",
                    'en': "6-Month Member (Expires: 2025/10/07)"
                },
            },
            courses: [
                { id: 1, title: {'zh-TW': "久坐上班族：全⾝活化⽪拉提斯", 'en': "Desk Worker's Relief: Full Body Activation"}, image: "https://images.unsplash.com/photo-1599447462856-c74143780775?q=80&w=1287&auto=format&fit=crop", progress: 75, category: {'zh-TW': '單堂體驗', 'en': 'Single Session'}, expiry: '2025/12/31' },
                { id: 5, title: {'zh-TW': "四周告別圓肩駝背", 'en': "4 Weeks to Fix Rounded Shoulders"}, image: "https://images.unsplash.com/photo-1518611012118-696072aa579a?q=80&w=1470&auto=format&fit=crop", progress: 25, category: {'zh-TW': '主題單元', 'en': 'Thematic Unit'}, expiry: '2025/12/31' },
                { id: 7, title: {'zh-TW': "8週完美體態重塑", 'en': "8-Week Perfect Posture Transformation"}, image: "https://images.unsplash.com/photo-1545205597-3d9d02c29597?q=80&w=1287&auto=format&fit=crop", progress: 10, category: {'zh-TW': '體態雕塑', 'en': 'Body Sculpting'}, expiry: '2026/03/15' },
                { id: 2, title: {'zh-TW': "核心強化：穩定與力量", 'en': "Core Strengthening: Stability & Power"}, image: "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?q=80&w=1470&auto=format&fit=crop", progress: 100, category: {'zh-TW': '單堂體驗', 'en': 'Single Session'}, expiry: '2025/08/01' },
                { id: 6, title: {'zh-TW': "四周打造緊實翹臀", 'en': "4 Weeks to a Firm, Lifted Glutes"}, image: "https://images.unsplash.com/photo-1603511422340-9a99b61d5b3c?q=80&w=1287&auto=format&fit=crop", progress: 0, category: {'zh-TW': '主題單元', 'en': 'Thematic Unit'}, expiry: '2025/09/20' },
            ]
            // To test the empty state, use this instead:
            // courses: []
        };

        // --- STATE ---
        let cartItems = [];
        let courseIdToAddAfterLogin = null;
        let currentLanguage = 'zh-TW';

        // --- DOM ELEMENTS ---
        const cartButton = document.getElementById('cart-button');
        const cartPanel = document.getElementById('cart-panel');
        const cartBackdrop = document.getElementById('cart-backdrop');
        const cartCloseButton = document.getElementById('cart-close-button');
        const cartContent = document.getElementById('cart-content');
        const cartItemCountBadge = document.getElementById('cart-item-count');

        const menuButton = document.getElementById('menu-button');
        const mobileMenuPanel = document.getElementById('mobile-menu-panel');
        const mobileMenuBackdrop = document.getElementById('mobile-menu-backdrop');
        const mobileMenuCloseButton = document.getElementById('mobile-menu-close');
        
        const authModalBackdrop = document.getElementById('auth-modal-backdrop');
        const authModalContainer = document.getElementById('auth-modal-container');
        const authModalCloseBtn = document.getElementById('auth-modal-close-btn');
        const userIconButton = document.getElementById('user-icon-button');
        const footerLoginLink = document.getElementById('footer-login-link');
        const loginForm = document.getElementById('loginForm');
        const languageSwitcherButton = document.getElementById('language-switcher-button');

        const dashboardHeaderContainer = document.getElementById('dashboard-header-container');
        const dashboardTabs = document.getElementById('dashboard-tabs');
        const myCoursesContent = document.getElementById('my-courses-content');
        const favoritesContent = document.getElementById('favorites-content');
        const historyContent = document.getElementById('history-content');
        const settingsContent = document.getElementById('settings-content');

        // --- I18N LOGIC ---
        const t = (key, params = {}) => {
            let translation = translations[currentLanguage][key] || key;
            for (const [param, value] of Object.entries(params)) {
                translation = translation.replace(`\${${param}}`, value);
            }
            return translation;
        };

        const updateStaticText = () => {
            document.title = t('page_title_dashboard');
            document.documentElement.lang = currentLanguage;

            document.querySelectorAll('[data-translate-key]').forEach(el => {
                const key = el.dataset.translateKey;
                const translation = t(key);

                if (el.placeholder !== undefined) {
                    el.placeholder = translation;
                } else if (el.tagName === 'INPUT' && el.type === 'submit' || el.tagName === 'BUTTON') {
                    // For buttons that might contain other elements
                    const textNode = Array.from(el.childNodes).find(node => node.nodeType === Node.TEXT_NODE);
                    if (textNode) {
                        textNode.textContent = translation + ' ';
                    } else if (el.querySelector('span')) {
                        el.querySelector('span').textContent = translation;
                    }
                     else {
                        el.textContent = translation;
                    }
                } else if (key === 'auth_terms_agree') {
                    // Special handling for terms agreement with links
                    const parts = currentLanguage === 'en' ? 
                        ['I agree to the ', ' and ', ''] : 
                        ['我同意 ', ' 與 ', ''];
                    const termsLink = `<a href="terms.html" target="_blank" class="underline hover:text-[#b0a9a4]">${(currentLanguage === 'en' ? 'Terms of Service' : '服務條款')}</a>`;
                    const privacyLink = `<a href="privacy.html" target="_blank" class="underline hover:text-[#b0a9a4]">${(currentLanguage === 'en' ? 'Privacy Policy' : '隱私政策')}</a>`;
                    el.innerHTML = `${parts[0]}${termsLink}${parts[1]}${privacyLink}${parts[2]}`;
                }
                 else {
                    el.innerHTML = translation;
                }
            });
            
            // Update password toggle text
            document.querySelectorAll('.password-toggle').forEach(btn => {
                const input = btn.previousElementSibling;
                btn.textContent = t(input.type === 'password' ? 'auth_show_password' : 'auth_hide_password');
            });
        };

        const setLanguage = (lang) => {
            currentLanguage = lang;
            localStorage.setItem('pilatesLanguage', lang);
            document.getElementById('current-lang-text').textContent = lang === 'en' ? 'EN' : '繁中';
            updateStaticText();
            // Re-render dynamic dashboard content
            renderDashboard();
            renderCart();
        };
        
        const initLanguage = () => {
            const savedLang = localStorage.getItem('pilatesLanguage');
            const browserLang = navigator.language.startsWith('en') ? 'en' : 'zh-TW';
            const lang = savedLang || browserLang;
            setLanguage(lang);
        };
        
        // --- AUTH LOGIC ---
        const checkLoginStatus = () => {
            const isLoggedIn = sessionStorage.getItem('isLoggedIn') === 'true';
            updateAuthUI(isLoggedIn);
            return isLoggedIn;
        };

        const updateAuthUI = (isLoggedIn) => {
            if (isLoggedIn) {
                userIconButton.classList.add('text-[#c1bcb8]');
            } else {
                userIconButton.classList.remove('text-[#c1bcb8]');
            }
        };
        
        const handleLogout = () => {
             if (confirm(t('logout_confirm'))) {
                sessionStorage.removeItem('isLoggedIn');
                checkLoginStatus();
                // Redirect to home page after logout from dashboard
                window.location.href = 'index.html';
            }
        };

        const openAuthModal = (view = 'login') => {
            document.querySelectorAll('.auth-view').forEach(v => v.classList.remove('active'));
            document.getElementById(`${view}View`).classList.add('active');
            authModalBackdrop.classList.add('active');
            authModalContainer.classList.add('active');
        };

        const closeAuthModal = () => {
            authModalBackdrop.classList.remove('active');
            authModalContainer.classList.remove('active');
        };

        // --- RENDER FUNCTIONS ---
        const renderCart = () => {
            if (cartItems.length === 0) {
                cartContent.innerHTML = `
                    <div class="flex-grow flex flex-col items-center justify-center text-center p-6 h-full">
                        <p class="text-stone-500">${t('cart_empty')}</p>
                        <button 
                            id="cart-continue-shopping"
                            class="mt-4 px-6 py-2 bg-[#c1bcb8] text-white rounded-full hover:bg-[#b0a9a4] transition-colors"
                        >
                            ${t('cart_continue_shopping')}
                        </button>
                    </div>
                `;
                const continueShoppingBtn = document.getElementById('cart-continue-shopping');
                if(continueShoppingBtn) continueShoppingBtn.addEventListener('click', closeCart);

            } else {
                const subtotal = cartItems.reduce((acc, item) => acc + item.price * item.quantity, 0);
                cartContent.innerHTML = `
                    <div class="flex-grow overflow-y-auto p-6 space-y-4">
                        ${cartItems.map(item => `
                            <div class="flex items-start space-x-4">
                                <img src="${item.image}" alt="${item.title[currentLanguage]}" class="w-24 h-24 object-cover rounded-md" />
                                <div class="flex-grow">
                                    <h3 class="font-semibold text-stone-800">${item.title[currentLanguage]}</h3>
                                    <p class="text-sm text-stone-500">NT$ ${item.price.toLocaleString()}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="p-6 border-t border-stone-200">
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-stone-600">${t('cart_subtotal')}</span>
                            <span class="text-xl font-semibold text-stone-800">NT$ ${subtotal.toLocaleString()}</span>
                        </div>
                        <button class="w-full py-3 bg-[#c1bcb8] text-white rounded-full text-lg font-semibold hover:bg-[#b0a9a4] transition-colors">
                            ${t('cart_checkout')}
                        </button>
                    </div>
                `;
            }
            updateCartCount();
        };

        const updateCartCount = () => {
            const totalItems = cartItems.reduce((sum, item) => sum + 1, 0);
            if (totalItems > 0) {
                cartItemCountBadge.textContent = totalItems;
                cartItemCountBadge.classList.remove('hidden');
            } else {
                cartItemCountBadge.classList.add('hidden');
            }
        };

        const renderDashboardHeader = (user) => {
            dashboardHeaderContainer.innerHTML = `
                <div class="flex items-center space-x-4">
                    <div class="flex-shrink-0 w-16 h-16 bg-white rounded-full flex items-center justify-center text-2xl font-bold text-[#c1bcb8] shadow-md">
                        ${user.name.charAt(0)}
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-stone-800">${t('dashboard_greeting', {userName: user.name})}</h1>
                        <p class="text-sm text-stone-600 font-medium">${user.membership[currentLanguage]}</p>
                    </div>
                </div>
            `;
        };

        const renderMyCourses = (courses) => {
            if (!courses || courses.length === 0) {
                myCoursesContent.innerHTML = `
                    <div class="text-center py-16 px-6 bg-white rounded-lg shadow-md">
                        <div class="text-6xl text-stone-300 mb-4">📚</div>
                        <h2 class="text-2xl font-bold font-serif text-stone-800 mb-2">${t('empty_courses_title')}</h2>
                        <p class="text-stone-500 mb-6">${t('empty_courses_subtitle')}</p>
                        <a href="index.html" class="inline-block px-8 py-3 bg-[#c1bcb8] text-white rounded-full font-semibold hover:bg-[#b0a9a4] transition-colors">
                            ${t('browse_courses')}
                        </a>
                    </div>
                `;
            } else {
                myCoursesContent.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        ${courses.map(course => `
                            <a href="course-details.html?id=${course.id}" class="bg-[#f9f9f9] rounded-lg shadow-lg overflow-hidden flex flex-col group transition-all duration-300 hover:shadow-2xl hover:-translate-y-1">
                               <div class="relative">
                                    <img src="${course.image}" alt="${course.title[currentLanguage]}" class="w-full h-48 object-cover" />
                                    <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"></div>
                                    <div class="absolute bottom-0 left-0 right-0 p-4 text-white">
                                        <div class="w-full bg-white/30 rounded-full h-1.5">
                                            <div class="bg-white h-1.5 rounded-full" style="width: ${course.progress}%"></div>
                                        </div>
                                        <p class="text-xs font-medium mt-1.5 text-right">${t('course_progress', {progress: course.progress})}</p>
                                    </div>
                               </div>
                               <div class="p-5 flex flex-col flex-grow">
                                    <p class="text-xs font-semibold text-stone-500 uppercase">${course.category[currentLanguage]}</p>
                                    <h3 class="text-md font-bold text-stone-800 mt-1">${course.title[currentLanguage]}</h3>
                                    <p class="text-xs text-stone-500 mt-2 flex-grow">${t('valid_until')} ${course.expiry}</p>
                                    <button class="w-full mt-4 py-2.5 bg-[#c1bcb8] text-white rounded-md text-sm font-semibold hover:bg-[#b0a9a4] transition-colors">
                                        ${course.progress > 0 ? t('continue_course') : t('start_course')}
                                    </button>
                               </div>
                            </a>
                        `).join('')}
                    </div>
                    <div class="mt-16 text-center py-12 px-6 bg-white rounded-lg shadow-md">
                         <h2 class="text-2xl font-bold font-serif text-stone-800 mb-2">${t('more_courses_title')}</h2>
                        <p class="text-stone-500 mb-6 max-w-xl mx-auto">${t('more_courses_subtitle')}</p>
                        <a href="index.html" class="inline-block px-8 py-3 bg-[#c1bcb8] text-white rounded-full font-semibold hover:bg-[#b0a9a4] transition-colors">
                            ${t('browse_courses')}
                        </a>
                    </div>
                `;
            }
        };
        
        const renderEmptyState = (container, { icon, titleKey, subtitleKey }) => {
            container.innerHTML = `
                <div class="text-center py-16 px-6 bg-white rounded-lg shadow-md">
                    <div class="text-6xl text-stone-300 mb-4">${icon}</div>
                    <h2 class="text-2xl font-bold font-serif text-stone-800 mb-2">${t(titleKey)}</h2>
                    <p class="text-stone-500 mb-6">${t(subtitleKey)}</p>
                    <a href="index.html" class="inline-block px-8 py-3 bg-[#c1bcb8] text-white rounded-full font-semibold hover:bg-[#b0a9a4] transition-colors">
                        ${t('browse_courses')}
                    </a>
                </div>
            `;
        };

        const renderSettings = (user) => {
            settingsContent.innerHTML = `
                <div class="max-w-2xl mx-auto bg-white p-8 rounded-lg shadow-md">
                    <h2 class="text-2xl font-bold font-serif text-stone-800 mb-6">${t('settings_title')}</h2>
                    <form id="settingsForm">
                         <div class="space-y-6">
                            <div>
                                <label for="name" class="block text-sm font-medium text-stone-700">${t('settings_name')}</label>
                                <input type="text" id="name" value="${user.name}" class="mt-1 block w-full px-4 py-3 border border-stone-300 rounded-md shadow-sm focus:outline-none focus:ring-[#c1bcb8] focus:border-[#c1bcb8] sm:text-sm">
                            </div>
                             <div>
                                <label for="email" class="block text-sm font-medium text-stone-700">${t('settings_email')}</label>
                                <input type="email" id="email" value="${user.email}" class="mt-1 block w-full px-4 py-3 border border-stone-300 rounded-md shadow-sm focus:outline-none focus:ring-[#c1bcb8] focus:border-[#c1bcb8] sm:text-sm">
                            </div>
                             <div>
                                <label class="block text-sm font-medium text-stone-700">${t('settings_password')}</label>
                                <button type="button" class="mt-1 text-sm font-semibold text-[#c1bcb8] hover:text-[#b0a9a4]">${t('settings_change_password')}</button>
                            </div>
                         </div>
                         <div class="flex justify-between items-center mt-8 pt-6 border-t border-stone-200">
                            <button type="submit" class="px-8 py-3 bg-[#c1bcb8] text-white rounded-full font-semibold hover:bg-[#b0a9a4] transition-colors">${t('settings_save')}</button>
                            <button type="button" id="logout-button" class="text-sm font-semibold text-red-600 hover:text-red-800">${t('settings_logout')}</button>
                         </div>
                    </form>
                </div>
            `;
            
            document.getElementById('logout-button').addEventListener('click', handleLogout);
            document.getElementById('settingsForm').addEventListener('submit', (e) => {
                e.preventDefault();
                alert(t('settings_saved_success'));
            });
        };
        
        const renderDashboard = () => {
            renderDashboardHeader(dashboardData.user);
            renderMyCourses(dashboardData.courses);
            renderEmptyState(favoritesContent, { icon: '🤍', titleKey: 'empty_favorites_title', subtitleKey: 'empty_favorites_subtitle' });
            renderEmptyState(historyContent, { icon: '📖', titleKey: 'empty_history_title', subtitleKey: 'empty_history_subtitle' });
            renderSettings(dashboardData.user);
        };

        // --- CART LOGIC with localStorage ---
        const saveCart = () => {
            localStorage.setItem('pilatesCart', JSON.stringify(cartItems));
        };

        const loadCart = () => {
            const savedCart = localStorage.getItem('pilatesCart');
            if (savedCart) {
                cartItems = JSON.parse(savedCart);
            } else {
                cartItems = [];
            }
        };

        // --- EVENT HANDLERS ---
        const openCart = () => {
            cartPanel.classList.remove('translate-x-full');
            cartBackdrop.classList.remove('opacity-0', 'pointer-events-none');
        };

        const closeCart = () => {
            cartPanel.classList.add('translate-x-full');
            cartBackdrop.classList.add('opacity-0', 'pointer-events-none');
        };

        const openMobileMenu = () => {
            mobileMenuPanel.classList.remove('-translate-x-full');
            mobileMenuBackdrop.classList.remove('opacity-0', 'pointer-events-none');
        };

        const closeMobileMenu = () => {
            mobileMenuPanel.classList.add('-translate-x-full');
            mobileMenuBackdrop.classList.add('opacity-0', 'pointer-events-none');
        };
        
        const handleTabClick = (e) => {
            const button = e.target.closest('.tab');
            if (!button) return;

            // Update tabs UI
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            button.classList.add('active');
            
            // Update content UI
            const tabName = button.dataset.tab;
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`${tabName}-content`).classList.add('active');
        };
        

        // --- INITIALIZATION ---
        
        // Protect the page - commented out for development as requested
        /*
        if (!checkLoginStatus()) {
            document.body.innerHTML = `
                <div class="flex items-center justify-center h-screen text-center">
                    <div>
                        <p class="text-lg text-stone-600 mb-2">${t('unauthorized_access')}</p>
                        <p class="text-sm text-stone-500">${t('redirecting_home')}</p>
                    </div>
                </div>
            `;
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 3000);
            return;
        }
        */

        initLanguage();
        loadCart();
        renderDashboard();
        renderCart();

        // Set default active tab
        document.querySelector('.tab[data-tab="my-courses"]').classList.add('active');
        document.getElementById('my-courses-content').classList.add('active');

        // EVENT LISTENERS
        cartButton.addEventListener('click', openCart);
        cartCloseButton.addEventListener('click', closeCart);
        cartBackdrop.addEventListener('click', closeCart);
        
        menuButton.addEventListener('click', openMobileMenu);
        mobileMenuCloseButton.addEventListener('click', closeMobileMenu);
        mobileMenuBackdrop.addEventListener('click', closeMobileMenu);

        userIconButton.addEventListener('click', () => {
             window.location.href = 'dashboard.html';
        }); // On dashboard, user icon could also just be a static indicator
        
        languageSwitcherButton.addEventListener('click', () => {
            const newLang = currentLanguage === 'en' ? 'zh-TW' : 'en';
            setLanguage(newLang);
        });

        dashboardTabs.addEventListener('click', handleTabClick);

    });
    </script>
</body>
</html>